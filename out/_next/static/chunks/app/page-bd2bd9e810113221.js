(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5873:function(e,t,s){Promise.resolve().then(s.bind(s,5394))},5394:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Home}});var a=s(7437),l=s(2265),i=s(5251),n=s(2167),r=s(9604),c=s(8253),o=s(8083),d=s(7972),x=s(9036),m=s(2549),h=s(5883),u=s(998),g=s(8004),p=s(2894),b=s(4698),y=s(1243),j=s(3773);function IncidentAlert(e){let{incident:t,onClose:s,autoClose:c=!0}=e,{selectedLanguage:o,getTranslatedText:d}=(0,r.useSafety)(),[x,h]=(0,l.useState)(!1),[u,g]=(0,l.useState)(!0),[f,N]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(!x&&t&&(playAlertSound(),speakAlertMessage(t)),c){let e=setTimeout(()=>{handleClose()},1e4);return()=>clearTimeout(e)}},[t,x,c]);let playAlertSound=()=>{try{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),s=e.createGain();t.connect(s),s.connect(e.destination),t.frequency.value=800,t.type="sine",s.gain.setValueAtTime(.3,e.currentTime),s.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),t.start(e.currentTime),t.stop(e.currentTime+.5),setTimeout(()=>{let t=e.createOscillator(),s=e.createGain();t.connect(s),s.connect(e.destination),t.frequency.value=800,t.type="sine",s.gain.setValueAtTime(.3,e.currentTime),s.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),t.start(e.currentTime),t.stop(e.currentTime+.5)},200)}catch(e){console.log("Audio playback not supported:",e)}},speakAlertMessage=e=>{if("speechSynthesis"in window&&!x){let t;window.speechSynthesis.cancel();let s=new SpeechSynthesisUtterance,a="critical"===e.severity?"malay"===o?"KECemasan! KECemasan!":"rojak"===o?"EMERGENCY! KECemasan!":"EMERGENCY! EMERGENCY!":"high"===e.severity?"malay"===o?"AMARAN! AMARAN!":"rojak"===o?"WARNING! AMARAN!":"WARNING! WARNING!":"malay"===o?"PERHATIAN!":"rojak"===o?"ATTENTION! PERHATIAN!":"ATTENTION!",l="".concat(a," ").concat("malay"===o?"Amaran Keselamatan!":"rojak"===o?"Safety Alert! Amaran Keselamatan!":"Safety Alert!"," ").concat(e.title,". ").concat("malay"===o?"Keterukan":"rojak"===o?"Severity / Keterukan":"Severity",": ").concat(e.severity.toUpperCase(),". ").concat("malay"===o?"Lokasi":"rojak"===o?"Location / Lokasi":"Location",": ").concat(e.location,". ").concat("malay"===o?"Ambil tindakan segera!":"rojak"===o?"Take immediate action! Ambil tindakan segera!":"Take immediate action!");s.text=l,"malay"===o?s.lang="ms-MY":s.lang="en-MY",s.rate=1.3,s.pitch=1.2,s.volume=1;let i=window.speechSynthesis.getVoices();"malay"===o&&(t=i.find(e=>e.lang.includes("ms")||e.lang.includes("Malay"))),t||(t=i.find(e=>e.name.includes("Female")||e.name.includes("Samantha")||e.name.includes("Karen")||e.name.includes("Zira")||e.lang.includes("en"))),t&&(s.voice=t),s.onstart=()=>N(!0),s.onend=()=>N(!1),s.onerror=()=>N(!1),window.speechSynthesis.speak(s)}},repeatMessage=()=>{t&&!x&&speakAlertMessage(t)},handleClose=()=>{"speechSynthesis"in window&&(window.speechSynthesis.cancel(),N(!1)),g(!1),setTimeout(()=>{s()},300)},getSeverityTextColor=e=>{switch(e){case"critical":return"text-red-400";case"high":return"text-orange-400";case"medium":return"text-yellow-400";case"low":return"text-blue-400";default:return"text-gray-400"}};return t&&u?(0,a.jsx)(n.M,{children:(0,a.jsx)(i.E.div,{initial:{opacity:0,y:-50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.9},className:"fixed top-4 right-4 z-50 max-w-md border-2 rounded-lg shadow-2xl ".concat((e=>{switch(e){case"critical":return"border-red-500 bg-red-500/90";case"high":return"border-orange-500 bg-orange-500/90";case"medium":return"border-yellow-500 bg-yellow-500/90";case"low":return"border-blue-500 bg-blue-500/90";default:return"border-gray-500 bg-gray-500/90"}})(t.severity)),children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(i.E.div,{animate:{rotate:[0,10,-10,0]},transition:{duration:.5,repeat:1/0,repeatDelay:2},children:(0,a.jsx)(p.Z,{className:"w-6 h-6 ".concat(getSeverityTextColor(t.severity))})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-white text-lg",children:"NEW INCIDENT ALERT"}),(0,a.jsxs)("p",{className:"text-sm font-semibold ".concat(getSeverityTextColor(t.severity)),children:[t.severity.toUpperCase()," SEVERITY"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{let e=!x;h(e),e?"speechSynthesis"in window&&(window.speechSynthesis.cancel(),N(!1)):t&&speakAlertMessage(t)},className:"p-1 rounded hover:bg-white/10 transition-colors",title:x?"Unmute":"Mute",children:x?(0,a.jsx)(b.Z,{className:"w-4 h-4 text-gray-400"}):(0,a.jsx)(y.Z,{className:"w-4 h-4 text-gray-400"})}),(0,a.jsx)("button",{onClick:repeatMessage,className:"p-1 rounded hover:bg-white/10 transition-colors",title:"Repeat Message",disabled:x,children:(0,a.jsx)(j.Z,{className:"w-4 h-4 ".concat(x?"text-gray-600":"text-construction-yellow"," ").concat(f?"animate-pulse":"")})}),(0,a.jsx)("button",{onClick:handleClose,className:"p-1 rounded hover:bg-white/10 transition-colors",children:(0,a.jsx)(m.Z,{className:"w-4 h-4 text-gray-400"})})]})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,a.jsx)("h4",{className:"font-semibold text-white",children:t.title}),(0,a.jsx)("p",{className:"text-sm text-gray-300",children:t.description}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-400",children:[(0,a.jsxs)("span",{children:["\uD83D\uDCCD ",t.location]}),(0,a.jsxs)("span",{children:["\uD83D\uDD50 ",t.time]}),(0,a.jsxs)("span",{children:["\uD83D\uDC64 ",t.reportedBy||"System"]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:handleClose,className:"flex-1 px-3 py-2 bg-construction-yellow text-black font-semibold rounded hover:bg-yellow-400 transition-colors text-sm",children:"Acknowledge & Review"}),(0,a.jsx)("button",{onClick:repeatMessage,disabled:x,className:"px-3 py-2 font-semibold rounded transition-colors text-sm ".concat(x?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:f?"Speaking...":"Repeat Alert"}),(0,a.jsx)("button",{onClick:handleClose,className:"px-3 py-2 bg-gray-600 text-white font-semibold rounded hover:bg-gray-500 transition-colors text-sm",children:"Dismiss"})]}),f&&(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-center space-x-2 text-xs text-construction-yellow",children:[(0,a.jsx)(j.Z,{className:"w-3 h-3 animate-pulse"}),(0,a.jsx)("span",{children:"ILMU AI is speaking..."})]}),c&&(0,a.jsx)("div",{className:"mt-3 h-1 bg-gray-700 rounded-full overflow-hidden",children:(0,a.jsx)(i.E.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:10,ease:"linear"},className:"h-full bg-construction-yellow"})})]})})}):null}var f=s(3008),N=s(6141),w=s(6142),v=s(5750),k=s(5790),S=s(5817),C=s(9883),A=s(2812),E=s(6637),T=s(930),P=s(2692),M=s.n(P);function ProjectManagerDashboard(){var e;let{complianceScore:t,activeZones:s,incidentLogs:n,reviewIncident:c,workers:o,sites:d,setShowWorkerModal:m,setShowSiteModal:h,updateWorker:g,updateSite:b,currentIncidentAlert:y,dismissIncidentAlert:j,addIncident:P,triggerIncidentAlert:I}=(0,r.useSafety)(),[D,R]=(0,l.useState)((null===(e=d.find(e=>"active"===e.status))||void 0===e?void 0:e.name)||""),[Z,L]=(0,l.useState)("all"),[W,F]=(0,l.useState)(!1),z=(0,l.useRef)(null),getSeverityColor=e=>{switch(e){case"critical":return"text-red-400 bg-red-400/10";case"high":return"text-orange-400 bg-orange-400/10";case"medium":return"text-yellow-400 bg-yellow-400/10";case"low":return"text-green-400 bg-green-400/10";default:return"text-gray-400 bg-gray-400/10"}},getStatusIcon=e=>{switch(e){case"completed":return(0,a.jsx)(f.Z,{className:"w-4 h-4 text-green-400"});case"pending_review":return(0,a.jsx)(N.Z,{className:"w-4 h-4 text-yellow-400"});case"active":return(0,a.jsx)(p.Z,{className:"w-4 h-4 text-red-400"});default:return(0,a.jsx)(u.Z,{className:"w-4 h-4 text-gray-400"})}},toggleWorkerStatus=e=>{let t=o.filter(t=>t.status!==e);t.length>0&&confirm("Change ".concat(t.length," worker(s) to ").concat(e,"?"))&&t.forEach(t=>{g(t.id,{status:e})})},toggleAllWorkersStatus=e=>{confirm("Set all workers to ".concat(e,"?"))&&o.forEach(t=>{g(t.id,{status:e})})},toggleSiteStatus=e=>{let t=d.filter(t=>t.status!==e);t.length>0&&confirm("Change ".concat(t.length," site(s) to ").concat(e,"?"))&&t.forEach(t=>{b(t.id,{status:e})})},toggleAllSitesStatus=e=>{confirm("Set all sites to ".concat(e,"?"))&&d.forEach(t=>{b(t.id,{status:e})})},showWorkerStatusModal=()=>{m(!0)},showSiteStatusModal=()=>{h(!0)},exportToPDF=async()=>{try{let e=z.current,t=await M()(e,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#0f0f0f"}),s=t.toDataURL("image/png"),a=new T.ZP("p","mm","a4"),l=210*t.height/t.width,i=l,n=0;for(a.addImage(s,"PNG",0,n,210,l),i-=297;i>=0;)n=i-l,a.addPage(),a.addImage(s,"PNG",0,n,210,l),i-=297;a.setProperties({title:"SafeSite AI Dashboard Report",subject:"Construction Safety Dashboard",author:"SafeSite AI System",keywords:"safety, construction, dashboard",creator:"SafeSite AI by YTL AI Labs"});let r=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);a.save("safesite-dashboard-".concat(r,".pdf"))}catch(e){console.error("Error generating PDF:",e),alert("Failed to generate PDF. Please try again.")}},exportIncidentToPDF=async e=>{try{let t=new T.ZP;if(t.setFont("helvetica"),t.setFontSize(20),t.setTextColor(255,184,0),t.text("INCIDENT REPORT",105,20,{align:"center"}),t.setFontSize(12),t.setTextColor(255,255,255),t.text("Incident Details:",20,40),t.setFontSize(10),t.setTextColor(200,200,200),t.text("Title: ".concat(e.title),20,50),t.text("Type: ".concat(e.type.replace("_"," ").toUpperCase()),20,60),t.text("Severity: ".concat(e.severity.toUpperCase()),20,70),t.text("Location: ".concat(e.location),20,80),t.text("Time: ".concat(e.time),20,90),t.text("Date: ".concat(e.date||new Date().toISOString().split("T")[0]),20,100),t.text("Status: ".concat(e.status.replace("_"," ").toUpperCase()),20,110),e.reportedBy&&t.text("Reported By: ".concat(e.reportedBy),20,120),e.description){t.setFontSize(12),t.setTextColor(255,255,255),t.text("Description:",20,140),t.setFontSize(10),t.setTextColor(200,200,200);let s=t.splitTextToSize(e.description,170);t.text(s,20,150)}if("near_miss"===e.type){let s=e.costSaved||Math.floor(1e5*Math.random())+1e4,a=e.potentialCost||s;t.setFontSize(12),t.setTextColor(255,255,255),t.text("Cost Analysis:",20,180),t.setFontSize(10),t.setTextColor(200,200,200),t.text("Potential Cost if Accident Occurred: RM ".concat(a.toLocaleString()),20,190),t.setTextColor(0,255,0),t.text("Cost Saved by Prevention: RM ".concat(s.toLocaleString()),20,200),t.setDrawColor(255,184,0),t.setLineWidth(.5),t.rect(15,175,180,35)}t.setFontSize(8),t.setTextColor(150,150,150),t.text("Generated by SafeSite AI - YTL AI Labs",105,280,{align:"center"}),t.text("Generated on: ".concat(new Date().toLocaleString()),105,285,{align:"center"});let s=e.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),a=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);t.save("incident-".concat(s,"-").concat(a,".pdf"))}catch(e){console.error("Error generating incident PDF:",e),alert("Failed to generate incident PDF. Please try again.")}};return(0,a.jsxs)("div",{className:"p-8",ref:z,children:[(0,a.jsxs)(i.E.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-white mb-4",children:"Project Manager Dashboard"}),(0,a.jsx)("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 overflow-hidden",children:(0,a.jsxs)("div",{className:"flex items-center space-x-8 animate-pulse-slow",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 text-construction-yellow"}),(0,a.jsxs)("span",{className:"text-construction-yellow font-semibold",children:[t,"% PPE Compliance"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(w.Z,{className:"w-5 h-5 text-green-400"}),(0,a.jsxs)("span",{className:"text-green-400 font-semibold",children:[d.length," Active Sites"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.Z,{className:"w-5 h-5 text-blue-400"}),(0,a.jsxs)("span",{className:"text-blue-400 font-semibold",children:[o.length," Total Workers"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(k.Z,{className:"w-5 h-5 text-purple-400"}),(0,a.jsx)("span",{className:"text-purple-400 font-semibold",children:"98% Safety Score Today"})]})]})})]}),(0,a.jsxs)(i.E.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"mb-6 flex flex-wrap gap-3",children:[(0,a.jsxs)("button",{onClick:exportToPDF,className:"flex items-center space-x-2 px-4 py-2 bg-construction-yellow text-black font-semibold rounded-lg hover:bg-yellow-400 transition-colors",children:[(0,a.jsx)(S.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Export Dashboard as PDF"})]}),(0,a.jsxs)("button",{onClick:()=>{let e={type:"near_miss",title:"Test Incident: Equipment Malfunction",description:"This is a test incident to demonstrate the alert system.",location:"Test Site - Zone A",severity:"high",status:"pending_review",potentialCost:5e4,costSaved:5e4};P(e),I(e)},className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 transition-colors",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Test Incident Alert"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[(0,a.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},className:"bg-dark-surface border border-dark-border rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white flex items-center",children:[(0,a.jsx)(k.Z,{className:"w-5 h-5 mr-2 text-green-400"}),"ROI Tracking"]}),(0,a.jsx)("span",{className:"text-xs text-green-400 bg-green-400/20 px-2 py-1 rounded",children:"+12.5%"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Safety Investment"}),(0,a.jsx)("span",{className:"text-white",children:"RM 250,000"})]}),(0,a.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-400 h-2 rounded-full",style:{width:"75%"}})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Cost Saved"}),(0,a.jsx)("span",{className:"text-green-400",children:"RM 425,000"})]}),(0,a.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-green-400 h-2 rounded-full",style:{width:"85%"}})})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-dark-border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"Net ROI"}),(0,a.jsx)("span",{className:"text-xl font-bold text-green-400",children:"70%"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"RM 175,000 net savings"})]})]})]}),(0,a.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.25},className:"bg-dark-surface border border-dark-border rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white flex items-center",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 mr-2 text-orange-400"}),"Risk Analytics"]}),(0,a.jsx)("span",{className:"text-xs text-yellow-400 bg-yellow-400/20 px-2 py-1 rounded",children:"Medium"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Critical Risk"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-red-400 rounded-full"}),(0,a.jsx)("span",{className:"text-white text-sm font-semibold",children:"2"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"High Risk"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-orange-400 rounded-full"}),(0,a.jsx)("span",{className:"text-white text-sm font-semibold",children:"5"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Medium Risk"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),(0,a.jsx)("span",{className:"text-white text-sm font-semibold",children:"8"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Low Risk"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),(0,a.jsx)("span",{className:"text-white text-sm font-semibold",children:"12"})]})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-dark-border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"Risk Score"}),(0,a.jsx)("span",{className:"text-xl font-bold text-yellow-400",children:"6.2"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Out of 10 (Lower is better)"})]})]})]}),(0,a.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},className:"bg-dark-surface border border-dark-border rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white flex items-center",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 mr-2 text-construction-yellow"}),"Compliance Report"]}),(0,a.jsx)("button",{onClick:()=>{try{let e=new T.ZP;e.setFont("helvetica"),e.setFontSize(20),e.setTextColor(255,184,0),e.text("COMPLIANCE & SAFETY REPORT",105,20,{align:"center"}),e.setFontSize(10),e.setTextColor(200,200,200),e.text("Generated on: ".concat(new Date().toLocaleString()),105,30,{align:"center"}),e.text("SafeSite AI - YTL AI Labs",105,35,{align:"center"}),e.setFontSize(14),e.setTextColor(255,255,255),e.text("Executive Summary",20,55),e.setFontSize(10),e.setTextColor(200,200,200);let s=e.splitTextToSize("This report provides a comprehensive overview of safety compliance and performance across all active construction sites. The overall compliance score of 91.7% indicates excellent adherence to safety protocols and regulations.",170);e.text(s,20,65);let a=65+5*s.length+10;e.setFontSize(14),e.setTextColor(255,255,255),e.text("Compliance Metrics",20,a),a+=10;let l=[{name:"PPE Compliance",score:t,status:"Excellent"},{name:"Safety Training",score:88,status:"Good"},{name:"Equipment Inspection",score:95,status:"Excellent"},{name:"Incident Response Time",score:92,status:"Excellent"},{name:"Hazard Reporting",score:85,status:"Good"}];l.forEach((t,s)=>{e.setFontSize(10),e.setTextColor(200,200,200),e.text("".concat(s+1,". ").concat(t.name,": ").concat(t.score,"% (").concat(t.status,")"),20,a+8*s)}),a+=8*l.length+15,e.setFontSize(14),e.setTextColor(255,255,255),e.text("Incident Analysis",20,a),a+=10;let i=n.length,r=n.filter(e=>"near_miss"===e.type).length,c=n.filter(e=>"violation"===e.type).length,o=n.filter(e=>"near_miss"===e.type).reduce((e,t)=>e+(t.costSaved||0),0);e.setFontSize(10),e.setTextColor(200,200,200),e.text("Total Incidents: ".concat(i),20,a),e.text("Near Misses: ".concat(r),20,a+8),e.text("Violations: ".concat(c),20,a+16),e.text("Total Cost Saved (Near Misses): RM ".concat(o.toLocaleString()),20,a+24),a+=40,e.setFontSize(14),e.setTextColor(255,255,255),e.text("Recommendations",20,a),a+=10,["Continue regular PPE inspections to maintain high compliance rate","Increase safety training frequency to improve overall score","Implement additional hazard identification programs","Enhance incident reporting system for faster response times","Conduct monthly safety audits to ensure continuous improvement"].forEach((t,s)=>{e.setFontSize(9),e.setTextColor(200,200,200);let l=e.splitTextToSize("".concat(s+1,". ").concat(t),170);e.text(l,20,a+12*s)}),e.setFontSize(8),e.setTextColor(150,150,150),e.text("This report is automatically generated by SafeSite AI system.",105,280,{align:"center"}),e.text("For questions or concerns, contact safety management team.",105,285,{align:"center"});let d=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);e.save("compliance-report-".concat(d,".pdf"))}catch(e){console.error("Error generating compliance report:",e),alert("Failed to generate compliance report. Please try again.")}},className:"text-xs text-construction-yellow hover:text-yellow-300 font-semibold",children:"Generate PDF"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"PPE Compliance"}),(0,a.jsxs)("span",{className:"text-white",children:[t,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-construction-yellow h-2 rounded-full",style:{width:"".concat(t,"%")}})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Safety Training"}),(0,a.jsx)("span",{className:"text-white",children:"88%"})]}),(0,a.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-400 h-2 rounded-full",style:{width:"88%"}})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Equipment Inspection"}),(0,a.jsx)("span",{className:"text-white",children:"95%"})]}),(0,a.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-green-400 h-2 rounded-full",style:{width:"95%"}})})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-dark-border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"Overall Score"}),(0,a.jsx)("span",{className:"text-xl font-bold text-construction-yellow",children:"91.7%"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Excellent Performance"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-3 grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[(0,a.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.05},className:"bg-dark-surface border border-dark-border rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center",children:(0,a.jsx)(v.Z,{className:"w-6 h-6 text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Worker Management"}),(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:[o.length," Total Workers"]})]})]}),(0,a.jsx)("button",{onClick:()=>m(!0),className:"p-2 bg-construction-yellow rounded-lg text-black hover:bg-yellow-400 transition-colors",children:(0,a.jsx)(C.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{className:"cursor-pointer hover:bg-dark-bg/50 p-2 rounded-lg transition-colors",onClick:()=>toggleWorkerStatus("active"),children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-green-400",children:o.filter(e=>"active"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Active"})]}),(0,a.jsxs)("div",{className:"cursor-pointer hover:bg-dark-bg/50 p-2 rounded-lg transition-colors",onClick:()=>toggleWorkerStatus("on_leave"),children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-400",children:o.filter(e=>"on_leave"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"On Leave"})]}),(0,a.jsxs)("div",{className:"cursor-pointer hover:bg-dark-bg/50 p-2 rounded-lg transition-colors",onClick:()=>toggleWorkerStatus("inactive"),children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-red-400",children:o.filter(e=>"inactive"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Inactive"})]})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Individual Worker Status:"}),(0,a.jsxs)("button",{onClick:()=>F(!W),className:"text-xs px-2 py-1 bg-gray-600/20 text-gray-400 rounded hover:bg-gray-600/30 transition-colors",children:[W?"Hide":"Show"," Workers"]})]}),W&&(0,a.jsx)("div",{className:"mt-2 space-y-2 max-h-48 overflow-y-auto",children:o.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-dark-bg/50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("active"===e.status?"bg-green-400":"on_leave"===e.status?"bg-yellow-400":"bg-red-400")}),(0,a.jsx)("span",{className:"text-xs text-white",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:["(",e.role,")"]})]}),(0,a.jsxs)("select",{value:e.status,onChange:t=>g(e.id,{status:t.target.value}),className:"text-xs bg-dark-border text-white px-2 py-1 rounded focus:outline-none focus:border-construction-yellow",children:[(0,a.jsx)("option",{value:"active",children:"Active"}),(0,a.jsx)("option",{value:"on_leave",children:"On Leave"}),(0,a.jsx)("option",{value:"inactive",children:"Inactive"})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"Quick Actions:"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>showWorkerStatusModal(),className:"text-xs px-2 py-1 bg-blue-500/20 text-blue-400 rounded hover:bg-blue-500/30 transition-colors",children:"Manage Workers"}),(0,a.jsx)("button",{onClick:()=>toggleAllWorkersStatus("active"),className:"text-xs px-2 py-1 bg-green-500/20 text-green-400 rounded hover:bg-green-500/30 transition-colors",children:"Activate All"})]})]})]}),(0,a.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"bg-dark-surface border border-dark-border rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center",children:(0,a.jsx)(A.Z,{className:"w-6 h-6 text-green-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Site Management"}),(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:[d.length," Total Sites"]})]})]}),(0,a.jsx)("button",{onClick:()=>h(!0),className:"p-2 bg-construction-yellow rounded-lg text-black hover:bg-yellow-400 transition-colors",children:(0,a.jsx)(C.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{className:"cursor-pointer hover:bg-dark-bg/50 p-2 rounded-lg transition-colors",onClick:()=>toggleSiteStatus("active"),children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-green-400",children:d.filter(e=>"active"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Active"})]}),(0,a.jsxs)("div",{className:"cursor-pointer hover:bg-dark-bg/50 p-2 rounded-lg transition-colors",onClick:()=>toggleSiteStatus("maintenance"),children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-400",children:d.filter(e=>"maintenance"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Maintenance"})]}),(0,a.jsxs)("div",{className:"cursor-pointer hover:bg-dark-bg/50 p-2 rounded-lg transition-colors",onClick:()=>toggleSiteStatus("inactive"),children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-red-400",children:d.filter(e=>"inactive"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Inactive"})]})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"Quick Actions:"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>showSiteStatusModal(),className:"text-xs px-2 py-1 bg-blue-500/20 text-blue-400 rounded hover:bg-blue-500/30 transition-colors",children:"Manage Sites"}),(0,a.jsx)("button",{onClick:()=>toggleAllSitesStatus("active"),className:"text-xs px-2 py-1 bg-green-500/20 text-green-400 rounded hover:bg-green-500/30 transition-colors",children:"Activate All Sites"})]})]})]})]}),(0,a.jsx)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.15},className:"lg:col-span-2",children:(0,a.jsxs)("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-white flex items-center",children:[(0,a.jsx)(w.Z,{className:"w-5 h-5 mr-2 text-construction-yellow"}),"Digital Twin - Site Overview"]}),(0,a.jsx)("select",{value:D,onChange:e=>R(e.target.value),className:"bg-dark-bg border border-dark-border text-white px-3 py-2 rounded-lg text-sm focus:outline-none focus:border-construction-yellow",children:d.filter(e=>"active"===e.status).map(e=>(0,a.jsx)("option",{value:"".concat(e.name," - ").concat(e.id),children:e.name},e.id))})]}),(0,a.jsxs)("div",{className:"relative bg-dark-bg rounded-lg p-8 h-96 overflow-hidden",children:[D&&(()=>{let e=D.split(" - ")[0],t=d.find(t=>t.name===e),s=o.filter(t=>t.assignedSite===e);return t?(0,a.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-white mb-4",children:e}),"High-rise Building"===t.projectType&&(0,a.jsxs)("svg",{viewBox:"0 0 400 300",className:"w-full h-full max-w-sm",children:[(0,a.jsx)("rect",{x:"20",y:"20",width:"360",height:"260",fill:"#1a1a1a",stroke:"#FFB800",strokeWidth:"2",rx:"8"}),(0,a.jsx)("rect",{x:"150",y:"180",width:"100",height:"80",fill:"#333",stroke:"#666",strokeWidth:"1"}),(0,a.jsx)("text",{x:"200",y:"225",fill:"#FFB800",textAnchor:"middle",fontSize:"10",children:"FOUNDATION"}),(0,a.jsx)("rect",{x:"160",y:"100",width:"80",height:"80",fill:"#444",stroke:"#888",strokeWidth:"1"}),(0,a.jsx)("rect",{x:"170",y:"110",width:"15",height:"15",fill:"#4A90E2",opacity:"0.7"}),(0,a.jsx)("rect",{x:"190",y:"110",width:"15",height:"15",fill:"#4A90E2",opacity:"0.7"}),(0,a.jsx)("rect",{x:"210",y:"110",width:"15",height:"15",fill:"#4A90E2",opacity:"0.7"}),(0,a.jsx)("rect",{x:"170",y:"130",width:"15",height:"15",fill:"#4A90E2",opacity:"0.7"}),(0,a.jsx)("rect",{x:"190",y:"130",width:"15",height:"15",fill:"#4A90E2",opacity:"0.7"}),(0,a.jsx)("rect",{x:"210",y:"130",width:"15",height:"15",fill:"#4A90E2",opacity:"0.7"}),(0,a.jsx)("rect",{x:"170",y:"150",width:"15",height:"15",fill:"#4A90E2",opacity:"0.7"}),(0,a.jsx)("rect",{x:"190",y:"150",width:"15",height:"15",fill:"#4A90E2",opacity:"0.7"}),(0,a.jsx)("rect",{x:"210",y:"150",width:"15",height:"15",fill:"#4A90E2",opacity:"0.7"}),(0,a.jsx)("line",{x1:"260",y1:"100",x2:"290",y2:"60",stroke:"#FFB800",strokeWidth:"3"}),(0,a.jsx)("circle",{cx:"290",cy:"60",r:"4",fill:"#FFB800"}),(0,a.jsx)("line",{x1:"287",y1:"60",x2:"287",y2:"80",stroke:"#FFB800",strokeWidth:"2"}),(0,a.jsx)("rect",{x:"50",y:"40",width:"60",height:"40",fill:"#ff000020",stroke:"#ff0000",strokeWidth:"2",rx:"3"}),(0,a.jsx)("text",{x:"80",y:"65",fill:"#ff0000",textAnchor:"middle",fontSize:"8",fontWeight:"bold",children:"CRANE ZONE"}),(0,a.jsx)("rect",{x:"290",y:"180",width:"70",height:"40",fill:"#ff000020",stroke:"#ff0000",strokeWidth:"2",rx:"3"}),(0,a.jsx)("text",{x:"325",y:"205",fill:"#ff0000",textAnchor:"middle",fontSize:"8",fontWeight:"bold",children:"MATERIALS"}),s.slice(0,6).map((e,t)=>(0,a.jsx)("g",{children:(0,a.jsx)("circle",{cx:60+t%3*30,cy:120+30*Math.floor(t/3),r:"4",fill:"#4A90E2"})},e.id)),(0,a.jsx)("circle",{cx:"350",cy:"40",r:"8",fill:"#00ff00",className:"glow-green",children:(0,a.jsx)("animate",{attributeName:"r",values:"8;12;8",dur:"2s",repeatCount:"indefinite"})})]}),"Infrastructure"===t.projectType&&(0,a.jsxs)("svg",{viewBox:"0 0 400 300",className:"w-full h-full max-w-sm",children:[(0,a.jsx)("rect",{x:"20",y:"20",width:"360",height:"260",fill:"#1a1a1a",stroke:"#FFB800",strokeWidth:"2",rx:"8"}),(0,a.jsx)("rect",{x:"40",y:"150",width:"320",height:"30",fill:"#666",stroke:"#888",strokeWidth:"1"}),(0,a.jsx)("rect",{x:"40",y:"180",width:"20",height:"60",fill:"#444"}),(0,a.jsx)("rect",{x:"120",y:"180",width:"20",height:"60",fill:"#444"}),(0,a.jsx)("rect",{x:"200",y:"180",width:"20",height:"60",fill:"#444"}),(0,a.jsx)("rect",{x:"280",y:"180",width:"20",height:"60",fill:"#444"}),(0,a.jsx)("rect",{x:"340",y:"180",width:"20",height:"60",fill:"#444"}),(0,a.jsx)("rect",{x:"40",y:"240",width:"320",height:"30",fill:"#1e3a8a",opacity:"0.5"}),(0,a.jsx)("text",{x:"200",y:"260",fill:"#60a5fa",textAnchor:"middle",fontSize:"10",children:"WATER"}),(0,a.jsx)("rect",{x:"150",y:"120",width:"40",height:"25",fill:"#ff6b35",stroke:"#ff8c42",strokeWidth:"1"}),(0,a.jsx)("text",{x:"170",y:"137",fill:"white",textAnchor:"middle",fontSize:"8",children:"EQUIP"}),(0,a.jsx)("rect",{x:"80",y:"100",width:"50",height:"30",fill:"#ff000020",stroke:"#ff0000",strokeWidth:"2",rx:"3"}),(0,a.jsx)("text",{x:"105",y:"120",fill:"#ff0000",textAnchor:"middle",fontSize:"8",fontWeight:"bold",children:"WELDING"}),(0,a.jsx)("rect",{x:"270",y:"100",width:"50",height:"30",fill:"#ff000020",stroke:"#ff0000",strokeWidth:"2",rx:"3"}),(0,a.jsx)("text",{x:"295",y:"120",fill:"#ff0000",textAnchor:"middle",fontSize:"8",fontWeight:"bold",children:"HEAVY LIFT"}),s.slice(0,5).map((e,t)=>(0,a.jsx)("g",{children:(0,a.jsx)("circle",{cx:100+50*t,cy:"165",r:"4",fill:"#4A90E2"})},e.id)),(0,a.jsx)("circle",{cx:"350",cy:"40",r:"8",fill:"#00ff00",className:"glow-green",children:(0,a.jsx)("animate",{attributeName:"r",values:"8;12;8",dur:"2s",repeatCount:"indefinite"})})]}),"Industrial"===t.projectType&&(0,a.jsxs)("svg",{viewBox:"0 0 400 300",className:"w-full h-full max-w-sm",children:[(0,a.jsx)("rect",{x:"20",y:"20",width:"360",height:"260",fill:"#1a1a1a",stroke:"#FFB800",strokeWidth:"2",rx:"8"}),(0,a.jsx)("rect",{x:"40",y:"60",width:"80",height:"60",fill:"#444",stroke:"#666",strokeWidth:"1"}),(0,a.jsx)("text",{x:"80",y:"95",fill:"#FFB800",textAnchor:"middle",fontSize:"9",children:"WAREHOUSE A"}),(0,a.jsx)("rect",{x:"140",y:"60",width:"80",height:"60",fill:"#444",stroke:"#666",strokeWidth:"1"}),(0,a.jsx)("text",{x:"180",y:"95",fill:"#FFB800",textAnchor:"middle",fontSize:"9",children:"WAREHOUSE B"}),(0,a.jsx)("rect",{x:"240",y:"60",width:"80",height:"60",fill:"#444",stroke:"#666",strokeWidth:"1"}),(0,a.jsx)("text",{x:"280",y:"95",fill:"#FFB800",textAnchor:"middle",fontSize:"9",children:"WAREHOUSE C"}),(0,a.jsx)("rect",{x:"40",y:"160",width:"280",height:"40",fill:"#333",stroke:"#555",strokeWidth:"1"}),(0,a.jsx)("text",{x:"180",y:"185",fill:"#999",textAnchor:"middle",fontSize:"9",children:"PARKING / LOADING"}),(0,a.jsx)("rect",{x:"150",y:"220",width:"60",height:"40",fill:"#555",stroke:"#777",strokeWidth:"1"}),(0,a.jsx)("text",{x:"180",y:"245",fill:"#FFB800",textAnchor:"middle",fontSize:"8",children:"OFFICE"}),(0,a.jsx)("rect",{x:"50",y:"140",width:"40",height:"15",fill:"#ff000020",stroke:"#ff0000",strokeWidth:"2",rx:"2"}),(0,a.jsx)("text",{x:"70",y:"150",fill:"#ff0000",textAnchor:"middle",fontSize:"7",fontWeight:"bold",children:"CHEMICAL"}),(0,a.jsx)("rect",{x:"250",y:"140",width:"40",height:"15",fill:"#ff000020",stroke:"#ff0000",strokeWidth:"2",rx:"2"}),(0,a.jsx)("text",{x:"270",y:"150",fill:"#ff0000",textAnchor:"middle",fontSize:"7",fontWeight:"bold",children:"FORKLIFT"}),s.slice(0,4).map((e,t)=>(0,a.jsx)("g",{children:(0,a.jsx)("circle",{cx:80+80*t,cy:"180",r:"4",fill:"#4A90E2"})},e.id)),(0,a.jsx)("circle",{cx:"350",cy:"40",r:"8",fill:"#ff0000",className:"glow-red",children:(0,a.jsx)("animate",{attributeName:"r",values:"8;12;8",dur:"1.5s",repeatCount:"indefinite"})})]}),!["High-rise Building","Infrastructure","Industrial"].includes(t.projectType)&&(0,a.jsxs)("svg",{viewBox:"0 0 400 300",className:"w-full h-full max-w-sm",children:[(0,a.jsx)("rect",{x:"20",y:"20",width:"360",height:"260",fill:"#1a1a1a",stroke:"#FFB800",strokeWidth:"2",rx:"8"}),(0,a.jsx)("rect",{x:"100",y:"80",width:"200",height:"120",fill:"#444",stroke:"#666",strokeWidth:"1"}),(0,a.jsx)("text",{x:"200",y:"145",fill:"#FFB800",textAnchor:"middle",fontSize:"12",children:"MAIN SITE AREA"}),t.hazards.slice(0,3).map((e,t)=>(0,a.jsxs)("g",{children:[(0,a.jsx)("rect",{x:50+t%3*100,y:40+30*Math.floor(t/3),width:"80",height:"25",fill:"#ff000020",stroke:"#ff0000",strokeWidth:"2",rx:"3"}),(0,a.jsx)("text",{x:90+t%3*100,y:57+30*Math.floor(t/3),fill:"#ff0000",textAnchor:"middle",fontSize:"8",fontWeight:"bold",children:e.substring(0,10)})]},t)),s.slice(0,6).map((e,t)=>(0,a.jsx)("g",{children:(0,a.jsx)("circle",{cx:120+t%4*40,cy:220+25*Math.floor(t/4),r:"4",fill:"#4A90E2"})},e.id)),(0,a.jsx)("circle",{cx:"350",cy:"40",r:"8",fill:"#00ff00",className:"glow-green",children:(0,a.jsx)("animate",{attributeName:"r",values:"8;12;8",dur:"2s",repeatCount:"indefinite"})})]}),(0,a.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-2 text-center",children:[(0,a.jsxs)("div",{className:"bg-dark-surface/50 p-2 rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Workers"}),(0,a.jsx)("p",{className:"text-lg font-bold text-white",children:s.length})]}),(0,a.jsxs)("div",{className:"bg-dark-surface/50 p-2 rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Hazards"}),(0,a.jsx)("p",{className:"text-lg font-bold text-red-400",children:t.hazards.length})]}),(0,a.jsxs)("div",{className:"bg-dark-surface/50 p-2 rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Status"}),(0,a.jsx)("p",{className:"text-sm font-bold capitalize",style:{color:"active"===t.status?"#00ff00":"maintenance"===t.status?"#ffb800":"#ff0000"},children:t.status})]})]})]}):null})(),(0,a.jsxs)("div",{className:"absolute bottom-4 left-4 bg-dark-surface/90 p-3 rounded-lg border border-dark-border",children:[(0,a.jsx)("div",{className:"text-xs font-semibold text-white mb-2",children:"Live Status"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-400 rounded-full glow-green"}),(0,a.jsx)("span",{className:"text-xs text-gray-300",children:"Safe Zone"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-red-400 rounded-full glow-red"}),(0,a.jsx)("span",{className:"text-xs text-gray-300",children:"Alert Zone"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),(0,a.jsx)("span",{className:"text-xs text-gray-300",children:"Worker"})]})]})]})]})]})}),(0,a.jsx)(i.E.div,{initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},children:(0,a.jsxs)("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 h-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-white flex items-center",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 mr-2 text-construction-yellow"}),"Incident Feed"]}),(0,a.jsxs)("select",{value:Z,onChange:e=>L(e.target.value),className:"bg-dark-bg border border-dark-border text-white px-3 py-2 rounded-lg text-sm focus:outline-none focus:border-construction-yellow",children:[(0,a.jsx)("option",{value:"all",children:"All Sites"}),d.filter(e=>"active"===e.status).map(e=>(0,a.jsx)("option",{value:"".concat(e.name," - ").concat(e.id),children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[n.filter(e=>"all"===Z||e.location.includes(Z.split(" - ")[0])).map(e=>(0,a.jsxs)(i.E.div,{whileHover:{scale:1.02},onClick:()=>"near_miss"===e.type&&c(e.id),className:"p-3 rounded-lg border transition-all cursor-pointer ".concat("near_miss"===e.type?"border-yellow-400/30 hover:border-yellow-400/50 hover:bg-yellow-400/5":"border-dark-border hover:bg-gray-800/50"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[getStatusIcon(e.status),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(getSeverityColor(e.severity)),children:e.severity.toUpperCase()})]}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:e.time})]}),(0,a.jsx)("h3",{className:"text-sm font-semibold text-white mb-1",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mb-2",children:[(0,a.jsx)(w.Z,{className:"w-3 h-3 inline mr-1"}),e.location]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-2",children:["near_miss"===e.type&&(0,a.jsx)("button",{className:"text-xs text-construction-yellow hover:text-yellow-300 font-semibold",children:"Review Near Miss â†’"}),(0,a.jsxs)("button",{onClick:()=>exportIncidentToPDF(e),className:"text-xs text-blue-400 hover:text-blue-300 font-semibold flex items-center space-x-1",children:[(0,a.jsx)(E.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Export PDF"})]})]}),"near_miss"===e.type&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-green-500/10 border border-green-500/30 rounded",children:[(0,a.jsxs)("p",{className:"text-xs text-green-400 font-semibold",children:["\uD83D\uDCB0 Cost Saved: RM ",(e.costSaved||Math.floor(1e5*Math.random())+1e4).toLocaleString()]}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Potential cost if accident occurred"})]})]},e.id)),0===n.filter(e=>"all"===Z||e.location.includes(Z.split(" - ")[0])).length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(u.Z,{className:"w-8 h-8 text-gray-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"all"===Z?"No incidents reported":"No incidents at ".concat(Z.split(" - ")[0])})]})]})]})})]}),y&&(0,a.jsx)(IncidentAlert,{incident:y,onClose:j,autoClose:!0})]})}var I=s(4035),D=s(9409),R=s(2127),Z=s(3101),L=s(4900);function LiveCCTV(){let{sites:e,currentUser:t}=(0,r.useSafety)(),[s,c]=(0,l.useState)(null),[o,d]=(0,l.useState)(!1),[x,h]=(0,l.useState)(!1),[u,g]=(0,l.useState)([]),[j,f]=(0,l.useState)(!1);(0,l.useRef)(null);let[N,w]=(0,l.useState)([{id:"CAM-001",name:"Main Entrance",location:"Zone A",status:"online",lastUpdate:new Date,detection:"personnel_detected",riskLevel:"low",videoId:"M2uIkL43yrM"},{id:"CAM-002",name:"Crane Area",location:"Zone B",status:"online",lastUpdate:new Date,detection:"equipment_movement",riskLevel:"medium",videoId:"-KDNFBgHdBc"},{id:"CAM-003",name:"Scaffolding",location:"Zone C",status:"online",lastUpdate:new Date,detection:"safety_violation",riskLevel:"high",videoId:"ZV3aI8vJUMo"},{id:"CAM-004",name:"Storage",location:"Zone D",status:"offline",lastUpdate:new Date(Date.now()-3e5),detection:"no_detection",riskLevel:"low",videoId:null}]);(0,l.useEffect)(()=>{let e=setInterval(()=>{if(w(e=>e.map(e=>({...e,lastUpdate:new Date,detection:Math.random()>.7?["personnel_detected","equipment_movement","safety_violation","no_detection"][Math.floor(4*Math.random())]:e.detection,status:Math.random()>.95?"offline":"offline"===e.status?"online":e.status}))),Math.random()>.8){let e=N[Math.floor(Math.random()*N.length)],t={id:Date.now(),cameraId:e?e.id:"UNKNOWN",type:["safety_violation","unauthorized_access","equipment_malfunction"][Math.floor(3*Math.random())],timestamp:new Date,severity:["low","medium","high"][Math.floor(3*Math.random())]};g(e=>[t,...e.slice(0,4)])}},5e3);return()=>clearInterval(e)},[N]);let handleCameraSelect=e=>{c(e)},getRiskLevelColor=e=>{switch(e){case"high":return"text-red-400 bg-red-500/10 border-red-500/30";case"medium":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"low":return"text-green-400 bg-green-500/10 border-green-500/30";default:return"text-gray-400 bg-gray-500/10 border-gray-500/30"}},getStatusColor=e=>{switch(e){case"online":return"text-green-400";case"offline":return"text-red-400";case"connecting":return"text-yellow-400";default:return"text-gray-400"}};return(0,a.jsx)("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:(0,a.jsx)("div",{className:"mobile-frame",children:(0,a.jsxs)("div",{className:"mobile-content bg-dark-bg h-full flex flex-col",children:[(0,a.jsx)(i.E.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-dark-surface border-b border-dark-border px-3 py-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"p-1 bg-construction-yellow rounded",children:(0,a.jsx)(I.Z,{className:"w-3 h-3 text-black"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xs font-bold text-white",children:"CCTV MONITORING"}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:[N.filter(e=>"online"===e.status).length,"/",N.length," ONLINE"]})]})]}),(0,a.jsx)("button",{onClick:()=>f(!0),className:"p-1 hover:bg-dark-bg rounded transition-colors",children:(0,a.jsx)(D.Z,{className:"w-3 h-3 text-gray-400"})})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:s?(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"flex-1 bg-black relative",children:["online"===s.status&&s.videoId?(0,a.jsx)("iframe",{src:"https://www.youtube.com/embed/".concat(s.videoId,"?autoplay=1&mute=1&loop=1&playlist=").concat(s.videoId,"&controls=0&showinfo=0&modestbranding=1&rel=0"),className:"w-full h-full border-0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(R.Z,{className:"w-8 h-8 text-red-400 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-gray-400 text-xs",children:"Camera Offline"})]})}),(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-b from-black/70 to-transparent p-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(I.Z,{className:"w-3 h-3 ".concat(getStatusColor(s.status))}),(0,a.jsx)("span",{className:"text-white text-xs font-medium",children:s.name}),(0,a.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded border ".concat(getRiskLevelColor(s.riskLevel)),children:s.riskLevel})]}),(0,a.jsx)("button",{onClick:()=>c(null),className:"p-1 bg-black/50 rounded text-white",children:(0,a.jsx)(m.Z,{className:"w-3 h-3"})})]})}),o&&(0,a.jsxs)("div",{className:"absolute top-12 left-2 flex items-center space-x-1 bg-red-500 text-white px-2 py-1 rounded",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-xs",children:"REC"})]}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{d(!o)},className:"p-1.5 rounded transition-colors ".concat(o?"bg-red-500 text-white":"bg-white/20 text-white"),children:o?(0,a.jsx)(Z.Z,{className:"w-3 h-3"}):(0,a.jsx)(L.Z,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:()=>{h(!x)},className:"p-1.5 bg-white/20 text-white rounded transition-colors",children:x?(0,a.jsx)(b.Z,{className:"w-3 h-3"}):(0,a.jsx)(y.Z,{className:"w-3 h-3"})})]}),(0,a.jsx)("div",{className:"text-white text-xs",children:new Date().toLocaleTimeString()})]})})]}),(0,a.jsx)("div",{className:"bg-dark-surface border-t border-dark-border p-2",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-400",children:"STATUS"}),(0,a.jsx)("p",{className:"font-semibold ".concat(getStatusColor(s.status)),children:s.status.toUpperCase()})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-400",children:"DETECTION"}),(0,a.jsx)("p",{className:"text-white font-semibold",children:s.detection.replace("_"," ").toUpperCase()})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-400",children:"LOCATION"}),(0,a.jsx)("p",{className:"text-white font-semibold",children:s.location})]})]})})]}):(0,a.jsxs)("div",{className:"p-2 space-y-3",children:[(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:N.map(e=>(0,a.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>handleCameraSelect(e),className:"bg-dark-surface border border-dark-border rounded-lg p-2 text-left transition-all hover:border-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(I.Z,{className:"w-3 h-3 ".concat(getStatusColor(e.status))}),(0,a.jsx)("span",{className:"text-white text-xs font-medium truncate",children:e.name})]}),(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("online"===e.status?"bg-green-400":"connecting"===e.status?"bg-yellow-400":"bg-red-400")})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-xs ".concat(getStatusColor(e.status)),children:e.status.toUpperCase()}),(0,a.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded border ".concat(getRiskLevelColor(e.riskLevel)),children:e.riskLevel})]})]},e.id))}),(0,a.jsxs)("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-2",children:[(0,a.jsx)("h3",{className:"text-white font-semibold mb-2 text-xs",children:"QUICK ACTIONS"}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-1",children:[(0,a.jsx)("button",{onClick:()=>d(!o),className:"p-2 rounded text-xs transition-colors ".concat(o?"bg-red-500 text-white":"bg-dark-bg text-gray-300 hover:bg-dark-border"),children:o?"STOP":"REC"}),(0,a.jsx)("button",{className:"p-2 bg-dark-bg text-gray-300 rounded hover:bg-dark-border transition-colors text-xs",children:"EXPORT"}),(0,a.jsx)("button",{className:"p-2 bg-dark-bg text-gray-300 rounded hover:bg-dark-border transition-colors text-xs",children:"SCAN"}),(0,a.jsx)("button",{className:"p-2 bg-construction-yellow text-black rounded hover:bg-yellow-400 transition-colors text-xs font-semibold",children:"SOS"})]})]}),(0,a.jsxs)("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-2",children:[(0,a.jsxs)("h3",{className:"text-white font-semibold mb-2 text-xs flex items-center",children:[(0,a.jsx)(p.Z,{className:"w-3 h-3 mr-1 text-construction-yellow"}),"RECENT ALERTS"]}),(0,a.jsx)("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:u.length>0?u.slice(0,3).map(e=>(0,a.jsx)("div",{className:"p-1.5 rounded border text-xs ".concat("high"===e.severity?"bg-red-500/10 border-red-500/30 text-red-400":"medium"===e.severity?"bg-yellow-500/10 border-yellow-500/30 text-yellow-400":"bg-green-500/10 border-green-500/30 text-green-400"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-semibold text-xs truncate",children:e.type.replace("_"," ").toUpperCase()}),(0,a.jsx)("span",{className:"text-xs opacity-75",children:e.timestamp.toLocaleTimeString()})]})},e.id)):(0,a.jsx)("p",{className:"text-gray-400 text-xs text-center py-2",children:"No alerts"})})]})]})}),(0,a.jsx)(n.M,{children:j&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>f(!1),children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-dark-surface border border-dark-border rounded-lg p-4 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-white font-semibold text-sm",children:"CCTV Settings"}),(0,a.jsx)("button",{onClick:()=>f(!1),className:"p-1 hover:bg-dark-bg rounded transition-colors",children:(0,a.jsx)(m.Z,{className:"w-3 h-3 text-gray-400"})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-gray-400 text-xs block mb-1",children:"Video Quality"}),(0,a.jsxs)("select",{className:"w-full p-1.5 bg-dark-bg border border-dark-border rounded text-white text-xs",children:[(0,a.jsx)("option",{children:"High (1080p)"}),(0,a.jsx)("option",{children:"Medium (720p)"}),(0,a.jsx)("option",{children:"Low (480p)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-gray-400 text-xs block mb-1",children:"Motion Detection"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{className:"px-2 py-1 bg-construction-yellow text-black rounded text-xs",children:"Enabled"}),(0,a.jsx)("button",{className:"px-2 py-1 bg-dark-bg text-gray-400 rounded text-xs",children:"Disabled"})]})]}),(0,a.jsx)("button",{className:"w-full p-1.5 bg-construction-yellow text-black rounded font-semibold hover:bg-yellow-400 transition-colors text-xs",children:"Save Settings"})]})]})})})]})})})}var W=s(2369),F=s(9670),z=s(1541),H=s(8339),O=s(8956);function SiteSupervisorApp(){let{simulateAIScan:e,scanResult:t,triggerViolationAlert:s,permits:c,approvePermit:o,rejectPermit:d,extendPermit:h,completePermit:u,selectedLanguage:g,setSelectedLanguage:b}=(0,r.useSafety)(),[y,j]=(0,l.useState)(!1),[w,v]=(0,l.useState)(0),[k,S]=(0,l.useState)(null),[C,A]=(0,l.useState)(!1),[T,P]=(0,l.useState)(!1),[M,R]=(0,l.useState)(!1),Z={english:{siteSupervisor:"Site Supervisor",realTimeSafetyManagement:"Real-time Safety Management",zaiActive:"Z.AI Active",settings:"Settings",activePermits:"Active Permits",hotWork:"Hot Work",confinedSpace:"Confined Space",electricalWork:"Electrical Work",checkHotWorkArea:"Check Hot Work Area",scanConfinedSpace:"Scan Confined Space",inspectElectricalPanel:"Inspect Electrical Panel",scanning:"Scanning...",zaiSafetyScan:"Z.AI Safety Scan",alertEngine:"Alert Engine",unhookedHarness:"Unhooked Harness",noHelmet:"No Helmet",unauthorizedAccess:"Unauthorized Access",test:"TEST",liveCctvMonitoring:"Live CCTV Monitoring",realTimeSiteSurveillance:"Real-time site surveillance",live:"LIVE",approve:"Approve",reject:"Reject",extend:"Extend",complete:"Complete",details:"Details",permitDetails:"Permit Details",location:"Location",requester:"Requester",status:"Status",timeRemaining:"Time Remaining",riskLevel:"Risk Level",description:"Description",safetyRequirements:"Safety Requirements",approvedBy:"Approved By",languageSettings:"Language Settings",selectLanguage:"Select Language",english:"English",bahasaMelayu:"Bahasa Melayu",bahasaRojak:"Bahasa Rojak",saveClose:"Save & Close",calling:"Calling...",callWorker:"Call Worker",repeatMessage:"Repeat Message"},malay:{siteSupervisor:"Penyelia Tapak",realTimeSafetyManagement:"Pengurusan Keselamatan Masa Nyata",zaiActive:"Z.AI Aktif",settings:"Tetapan",activePermits:"Permit Aktif",hotWork:"Kerja Panas",confinedSpace:"Ruang Terhad",electricalWork:"Kerja Elektrik",checkHotWorkArea:"Semak Kawasan Kerja Panas",scanConfinedSpace:"Imbas Ruang Terhad",inspectElectricalPanel:"Periksa Panel Elektrik",scanning:"Mengimbas...",zaiSafetyScan:"Imbasan Keselamatan Z.AI",alertEngine:"Enjin Amaran",unhookedHarness:"Tali Keledar Tidak Dikait",noHelmet:"Tiada Topi Keselamatan",unauthorizedAccess:"Akses Tanpa Kebenaran",test:"UJI",liveCctvMonitoring:"Pemantauan CCTV Langsung",realTimeSiteSurveillance:"Pengawasan tapak masa nyata",live:"LANGSUNG",approve:"Lulus",reject:"Tolak",extend:"Panjang",complete:"Selesai",details:"Butiran",permitDetails:"Butiran Permit",location:"Lokasi",requester:"Pemohon",status:"Status",timeRemaining:"Masa Berbaki",riskLevel:"Tahap Risiko",description:"Keterangan",safetyRequirements:"Keperluan Keselamatan",approvedBy:"Diluluskan Oleh",languageSettings:"Tetapan Bahasa",selectLanguage:"Pilih Bahasa",english:"English",bahasaMelayu:"Bahasa Melayu",bahasaRojak:"Bahasa Rojak",saveClose:"Simpan & Tutup",calling:"Memanggil...",callWorker:"Panggil Pekerja",repeatMessage:"Ulangi Mesej"},rojak:{siteSupervisor:"Site Supervisor / Penyelia Tapak",realTimeSafetyManagement:"Real-time Safety Management / Pengurusan Keselamatan Masa Nyata",zaiActive:"Z.AI Active / Z.AI Aktif",settings:"Settings / Tetapan",activePermits:"Active Permits / Permit Aktif",hotWork:"Hot Work / Kerja Panas",confinedSpace:"Confined Space / Ruang Terhad",electricalWork:"Electrical Work / Kerja Elektrik",checkHotWorkArea:"Check Hot Work Area / Semak Kawasan Kerja Panas",scanConfinedSpace:"Scan Confined Space / Imbas Ruang Terhad",inspectElectricalPanel:"Inspect Electrical Panel / Periksa Panel Elektrik",scanning:"Scanning... / Mengimbas...",zaiSafetyScan:"Z.AI Safety Scan / Imbasan Keselamatan Z.AI",alertEngine:"Alert Engine / Enjin Amaran",unhookedHarness:"Unhooked Harness / Tali Keledar Tidak Dikait",noHelmet:"No Helmet / Tiada Topi Keselamatan",unauthorizedAccess:"Unauthorized Access / Akses Tanpa Kebenaran",test:"TEST / UJI",liveCctvMonitoring:"Live CCTV Monitoring / Pemantauan CCTV Langsung",realTimeSiteSurveillance:"Real-time site surveillance / Pengawasan tapak masa nyata",live:"LIVE / LANGSUNG",approve:"Approve / Lulus",reject:"Reject / Tolak",extend:"Extend / Panjang",complete:"Complete / Selesai",details:"Details / Butiran",permitDetails:"Permit Details / Butiran Permit",location:"Location / Lokasi",requester:"Requester / Pemohon",status:"Status / Status",timeRemaining:"Time Remaining / Masa Berbaki",riskLevel:"Risk Level / Tahap Risiko",description:"Description / Keterangan",safetyRequirements:"Safety Requirements / Keperluan Keselamatan",approvedBy:"Approved By / Diluluskan Oleh",languageSettings:"Language Settings / Tetapan Bahasa",selectLanguage:"Select Language / Pilih Bahasa",english:"English",bahasaMelayu:"Bahasa Melayu",bahasaRojak:"Bahasa Rojak",saveClose:"Save & Close / Simpan & Tutup",calling:"Calling... / Memanggil...",callWorker:"Call Worker / Panggil Pekerja",repeatMessage:"Repeat Message / Ulangi Mesej"}},L=Z[g]||Z.english,handleAIScan=t=>{j(!0),v(0),e(t);let s=setInterval(()=>{v(e=>e>=100?(clearInterval(s),j(!1),100):e+20)},400)},handlePermitAction=(e,t)=>{switch(t){case"approve":o(e.id);break;case"reject":d(e.id,"Safety requirements not fully met");break;case"extend":h(e.id,2);break;case"complete":u(e.id)}A(!1),S(null)},openPermitActions=e=>{S(e),A(!0)},getStatusColor=e=>{switch(e){case"active":return"text-green-400 bg-green-400/10 border-green-400/30";case"pending":return"text-yellow-400 bg-yellow-400/10 border-yellow-400/30";case"rejected":case"expired":return"text-red-400 bg-red-400/10 border-red-400/30";case"completed":return"text-blue-400 bg-blue-400/10 border-blue-400/30";default:return"text-gray-400 bg-gray-400/10 border-gray-400/30"}};return(0,a.jsxs)("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"mobile-frame",children:(0,a.jsxs)("div",{className:"mobile-content bg-dark-surface",children:[(0,a.jsx)("div",{className:"bg-construction-yellow text-black p-4 sticky top-0 z-10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-bold",children:L.siteSupervisor}),(0,a.jsx)("p",{className:"text-xs opacity-80",children:L.realTimeSafetyManagement})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>P(!0),className:"p-2 hover:bg-black/10 rounded-lg transition-colors",title:L.settings,children:(0,a.jsx)(D.Z,{className:"w-5 h-5"})}),(0,a.jsx)(x.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"text-sm font-semibold",children:L.zaiActive})]})]})}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},children:[(0,a.jsxs)("h2",{className:"text-white font-semibold mb-3 flex items-center",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),L.activePermits]}),(0,a.jsx)("div",{className:"space-y-2",children:c.map(e=>(0,a.jsxs)(i.E.div,{whileHover:{scale:1.02},className:"p-3 rounded-lg border ".concat(getStatusColor(e.status)),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-semibold text-sm",children:e.type}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full bg-black/20",children:e.status.toUpperCase()})]}),(0,a.jsx)("p",{className:"text-xs opacity-80 mb-1",children:e.location}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-xs opacity-60",children:["By: ",e.requester]}),(0,a.jsxs)("span",{className:"text-xs opacity-60 flex items-center",children:[(0,a.jsx)(N.Z,{className:"w-3 h-3 mr-1"}),e.expiry]})]}),(0,a.jsxs)("div",{className:"flex gap-1 mt-2",children:["pending"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>handlePermitAction(e,"approve"),className:"flex-1 px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded hover:bg-green-500/30 transition-colors",children:L.approve}),(0,a.jsx)("button",{onClick:()=>handlePermitAction(e,"reject"),className:"flex-1 px-2 py-1 bg-red-500/20 text-red-400 text-xs rounded hover:bg-red-500/30 transition-colors",children:L.reject})]}),"active"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>handlePermitAction(e,"extend"),className:"flex-1 px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded hover:bg-blue-500/30 transition-colors",children:L.extend}),(0,a.jsx)("button",{onClick:()=>handlePermitAction(e,"complete"),className:"flex-1 px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded hover:bg-yellow-500/30 transition-colors",children:L.complete})]}),(0,a.jsx)("button",{onClick:()=>openPermitActions(e),className:"px-2 py-1 bg-gray-500/20 text-gray-400 text-xs rounded hover:bg-gray-500/30 transition-colors",children:L.details})]})]},e.id))})]}),(0,a.jsxs)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:[(0,a.jsxs)("h2",{className:"text-white font-semibold mb-3 flex items-center",children:[(0,a.jsx)(W.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),L.zaiSafetyScan]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("button",{onClick:()=>handleAIScan("hot_work"),disabled:y,className:"w-full p-4 bg-dark-bg border border-dark-border rounded-lg hover:border-construction-yellow transition-all disabled:opacity-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(I.Z,{className:"w-5 h-5 text-construction-yellow"}),(0,a.jsx)("span",{className:"text-sm font-semibold",children:L.checkHotWorkArea})]}),(0,a.jsx)(F.Z,{className:"w-4 h-4 text-gray-400"})]})}),(0,a.jsx)("button",{onClick:()=>handleAIScan("confined_space"),disabled:y,className:"w-full p-4 bg-dark-bg border border-dark-border rounded-lg hover:border-construction-yellow transition-all disabled:opacity-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(I.Z,{className:"w-5 h-5 text-construction-yellow"}),(0,a.jsx)("span",{className:"text-sm font-semibold",children:L.scanConfinedSpace})]}),(0,a.jsx)(F.Z,{className:"w-4 h-4 text-gray-400"})]})}),(0,a.jsx)("button",{onClick:()=>handleAIScan("electrical"),disabled:y,className:"w-full p-4 bg-dark-bg border border-dark-border rounded-lg hover:border-construction-yellow transition-all disabled:opacity-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(I.Z,{className:"w-5 h-5 text-construction-yellow"}),(0,a.jsx)("span",{className:"text-sm font-semibold",children:L.inspectElectricalPanel})]}),(0,a.jsx)(F.Z,{className:"w-4 h-4 text-gray-400"})]})})]}),(0,a.jsx)(n.M,{children:y&&(0,a.jsx)(i.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3",children:(0,a.jsxs)("div",{className:"p-3 bg-dark-bg rounded-lg border border-construction-yellow/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(z.Z,{className:"w-4 h-4 text-construction-yellow animate-pulse"}),(0,a.jsx)("span",{className:"text-sm text-construction-yellow",children:L.scanning})]}),(0,a.jsx)("div",{className:"w-full bg-dark-border rounded-full h-2",children:(0,a.jsx)(i.E.div,{className:"bg-construction-yellow h-2 rounded-full",initial:{width:0},animate:{width:"".concat(w,"%")},transition:{duration:.3}})})]})})}),(0,a.jsx)(n.M,{children:t&&!y&&(0,a.jsx)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-3 p-3 rounded-lg border ".concat("approved"===t.status?"bg-green-400/10 border-green-400/30":"bg-yellow-400/10 border-yellow-400/30"),children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:["approved"===t.status?(0,a.jsx)(f.Z,{className:"w-5 h-5 text-green-400 mt-0.5"}):(0,a.jsx)(p.Z,{className:"w-5 h-5 text-yellow-400 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-white font-semibold mb-1",children:"approved"===t.status?L.approve+"d":"Action Required"}),(0,a.jsx)("p",{className:"text-xs text-gray-300",children:t.message}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Confidence: ",t.confidence,"%"]})]})]})})})]}),(0,a.jsxs)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},children:[(0,a.jsxs)("h2",{className:"text-white font-semibold mb-3 flex items-center",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),L.alertEngine]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("button",{onClick:()=>s("Rahman","UNHOOKED HARNESS"),className:"w-full p-3 bg-red-500/10 border border-red-500/30 rounded-lg hover:bg-red-500/20 transition-all",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(p.Z,{className:"w-5 h-5 text-red-400"}),(0,a.jsx)("span",{className:"text-sm font-semibold text-red-400",children:L.unhookedHarness})]}),(0,a.jsx)("span",{className:"text-xs text-red-400 opacity-60",children:L.test})]})}),(0,a.jsx)("button",{onClick:()=>s("Ahmed","NO HELMET"),className:"w-full p-3 bg-orange-500/10 border border-orange-500/30 rounded-lg hover:bg-orange-500/20 transition-all",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(p.Z,{className:"w-5 h-5 text-orange-400"}),(0,a.jsx)("span",{className:"text-sm font-semibold text-orange-400",children:L.noHelmet})]}),(0,a.jsx)("span",{className:"text-xs text-orange-400 opacity-60",children:L.test})]})}),(0,a.jsx)("button",{onClick:()=>s("Siti","UNAUTHORIZED ACCESS"),className:"w-full p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg hover:bg-yellow-500/20 transition-all",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(p.Z,{className:"w-5 h-5 text-yellow-400"}),(0,a.jsx)("span",{className:"text-sm font-semibold text-yellow-400",children:L.unauthorizedAccess})]}),(0,a.jsx)("span",{className:"text-xs text-yellow-400 opacity-60",children:L.test})]})})]})]}),(0,a.jsx)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},children:(0,a.jsx)("button",{onClick:()=>R(!0),className:"w-full p-6 bg-gradient-to-r from-construction-yellow to-yellow-400 text-black rounded-lg hover:from-yellow-400 hover:to-yellow-500 transition-all shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-3 bg-black/20 rounded-lg",children:(0,a.jsx)(H.Z,{className:"w-8 h-8"})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h3",{className:"text-lg font-bold",children:L.liveCctvMonitoring}),(0,a.jsx)("p",{className:"text-sm opacity-80",children:L.realTimeSiteSurveillance})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"px-3 py-1 bg-black/20 rounded-full",children:(0,a.jsx)("span",{className:"text-sm font-semibold",children:L.live})}),(0,a.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"})]})]})})})]})]})}),(0,a.jsxs)(n.M,{children:[C&&k&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:()=>A(!1),children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-dark-surface rounded-lg p-4 max-w-sm w-full max-h-[80vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:L.permitDetails}),(0,a.jsx)("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-white",children:"âœ•"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:L.permitType||"Permit Type"}),(0,a.jsx)("p",{className:"text-sm font-semibold text-white",children:k.type})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:L.location}),(0,a.jsx)("p",{className:"text-sm text-white",children:k.location})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:L.requester}),(0,a.jsx)("p",{className:"text-sm text-white",children:k.requester})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:L.status}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs rounded-full ".concat(getStatusColor(k.status)),children:k.status.toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:L.timeRemaining}),(0,a.jsxs)("p",{className:"text-sm text-white flex items-center",children:[(0,a.jsx)(N.Z,{className:"w-3 h-3 mr-1"}),k.expiry]})]}),k.description&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:L.description}),(0,a.jsx)("p",{className:"text-sm text-white",children:k.description})]}),k.riskLevel&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:L.riskLevel}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs rounded ".concat("high"===k.riskLevel?"bg-red-500/20 text-red-400":"medium"===k.riskLevel?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"),children:k.riskLevel.toUpperCase()})]}),k.requirements&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:L.safetyRequirements}),(0,a.jsx)("div",{className:"space-y-1",children:k.requirements.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center text-xs text-white",children:[(0,a.jsx)(f.Z,{className:"w-3 h-3 mr-2 text-green-400"}),e]},t))})]}),k.approvedBy&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:L.approvedBy}),(0,a.jsx)("p",{className:"text-sm text-white",children:k.approvedBy}),k.approvedAt&&(0,a.jsx)("p",{className:"text-xs text-gray-400",children:k.approvedAt})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-4",children:["pending"===k.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>handlePermitAction(k,"approve"),className:"flex-1 px-3 py-2 bg-green-500 text-white text-sm rounded hover:bg-green-600 transition-colors",children:L.approve}),(0,a.jsx)("button",{onClick:()=>handlePermitAction(k,"reject"),className:"flex-1 px-3 py-2 bg-red-500 text-white text-sm rounded hover:bg-red-600 transition-colors",children:L.reject})]}),"active"===k.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>handlePermitAction(k,"extend"),className:"flex-1 px-3 py-2 bg-blue-500 text-white text-sm rounded hover:bg-blue-600 transition-colors",children:[L.extend," +2h"]}),(0,a.jsx)("button",{onClick:()=>handlePermitAction(k,"complete"),className:"flex-1 px-3 py-2 bg-yellow-500 text-white text-sm rounded hover:bg-yellow-600 transition-colors",children:L.complete})]})]})]})}),T&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:()=>P(!1),children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-dark-surface rounded-lg p-4 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white flex items-center",children:[(0,a.jsx)(O.Z,{className:"w-5 h-5 mr-2 text-construction-yellow"}),L.languageSettings]}),(0,a.jsx)("button",{onClick:()=>P(!1),className:"text-gray-400 hover:text-white",children:"âœ•"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-300 mb-3",children:"Select your preferred language for interface, alerts and notifications:"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("button",{onClick:()=>b("english"),className:"w-full p-3 rounded-lg border transition-all ".concat("english"===g?"bg-construction-yellow/20 border-construction-yellow text-construction-yellow":"bg-dark-bg border-dark-border text-gray-300 hover:border-construction-yellow/50"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-lg mr-3",children:"\uD83C\uDDEC\uD83C\uDDE7"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-semibold",children:L.english}),(0,a.jsx)("p",{className:"text-xs opacity-70",children:"Default language"})]})]}),"english"===g&&(0,a.jsx)("div",{className:"w-4 h-4 bg-construction-yellow rounded-full"})]})}),(0,a.jsx)("button",{onClick:()=>b("malay"),className:"w-full p-3 rounded-lg border transition-all ".concat("malay"===g?"bg-construction-yellow/20 border-construction-yellow text-construction-yellow":"bg-dark-bg border-dark-border text-gray-300 hover:border-construction-yellow/50"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-lg mr-3",children:"\uD83C\uDDF2\uD83C\uDDFE"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-semibold",children:L.bahasaMelayu}),(0,a.jsx)("p",{className:"text-xs opacity-70",children:"Bahasa kebangsaan"})]})]}),"malay"===g&&(0,a.jsx)("div",{className:"w-4 h-4 bg-construction-yellow rounded-full"})]})}),(0,a.jsx)("button",{onClick:()=>b("rojak"),className:"w-full p-3 rounded-lg border transition-all ".concat("rojak"===g?"bg-construction-yellow/20 border-construction-yellow text-construction-yellow":"bg-dark-bg border-dark-border text-gray-300 hover:border-construction-yellow/50"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-lg mr-3",children:"\uD83C\uDDF2\uD83C\uDDFE\uD83C\uDDEC\uD83C\uDDE7"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-semibold",children:L.bahasaRojak}),(0,a.jsx)("p",{className:"text-xs opacity-70",children:"English + Malay mix"})]})]}),"rojak"===g&&(0,a.jsx)("div",{className:"w-4 h-4 bg-construction-yellow rounded-full"})]})})]}),(0,a.jsxs)("div",{className:"mt-4 p-3 bg-dark-bg rounded-lg border border-dark-border",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"Preview:"}),(0,a.jsxs)("p",{className:"text-sm text-white",children:["english"===g&&"WARNING: Unhooked Safety Harness","malay"===g&&"AMARAN: Tali pinggang keselamatan tidak dipasang","rojak"===g&&"Woi Rahman! Tali safety tak pasang lagi ke? Alamak, gila bahaya weh! Cepat pasang la!"]})]})]}),(0,a.jsx)("div",{className:"flex gap-2 mt-4",children:(0,a.jsx)("button",{onClick:()=>P(!1),className:"flex-1 px-4 py-2 bg-construction-yellow text-black font-semibold rounded hover:bg-yellow-400 transition-colors",children:L.saveClose})})]})}),(0,a.jsx)(n.M,{children:M&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 z-50",onClick:()=>R(!1),children:(0,a.jsx)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full h-full",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"relative w-full h-full",children:[(0,a.jsx)("button",{onClick:()=>R(!1),className:"absolute top-4 right-4 z-10 p-2 bg-black/50 rounded-lg hover:bg-black/70 transition-colors",children:(0,a.jsx)(m.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsx)(LiveCCTV,{})]})})})})]})]})}var B=s(5298),K=s(3546),U=s(9933),q=s(2741),V=s(2176);function WorkerDigitalPassport(){let{simulateRedZone:e,redZoneActive:t,selectedLanguage:s,setSelectedLanguage:c,addPermit:o,permits:h,currentUser:u,workers:g,sites:b}=(0,r.useSafety)(),[j,f]=(0,l.useState)(null),[v,k]=(0,l.useState)(!1),[S,C]=(0,l.useState)(0),[A,T]=(0,l.useState)(!1),[P,M]=(0,l.useState)([]),[I,R]=(0,l.useState)(!1),[F,z]=(0,l.useState)(!1),[H,_]=(0,l.useState)({type:"Hot Work",location:"",description:"",duration:"2 hours",riskLevel:"medium"}),[G,Y]=(0,l.useState)(""),J={name:"Ahmed Rahman",id:"WRK-2024-0892",role:"Construction Worker",department:"Structural Works",certifications:["PPE Certified","Height Safety","First Aid"],complianceScore:98,phone:"+6012-345-6789",emergencyContact:"+6012-987-6543",siteAssigned:"Kuala Lumpur Tower Project"};(0,l.useEffect)(()=>{let loadVoices=()=>{let e=window.speechSynthesis.getVoices();M(e)};loadVoices(),void 0!==window.speechSynthesis.onvoiceschanged&&(window.speechSynthesis.onvoiceschanged=loadVoices)},[]),(0,l.useEffect)(()=>{let generateQRCode=async()=>{try{let e=JSON.stringify({workerId:J.id,name:J.name,role:J.role,site:J.siteAssigned,timestamp:new Date().toISOString()}),t=await B.toDataURL(e,{width:200,margin:1,color:{dark:"#000000",light:"#FFFFFF"}});Y(t)}catch(e){console.error("Error generating QR code:",e)}};generateQRCode()},[]);let Q={english:{digitalPassport:"Digital Passport",scanForVerification:"Scan for Verification",workerInfo:"Worker Information",role:"Role",department:"Department",phone:"Phone",emergency:"Emergency",certifications:"Certifications",sopLibrary:"SOP Library",ladderSafety:"Ladder Safety",craneOperations:"Crane Operations",electricalSafety:"Electrical Safety",chemicalHandling:"Chemical Handling",quickActions:"Quick Actions",emergencyCall:"Emergency Call",supervisorContact:"Supervisor Contact",siteMap:"Site Map",redZoneAlert:"Red Zone Alert",playing:"Playing...",paused:"Paused",speaking:"Speaking...",settings:"Settings",language:"Language",selectLanguage:"Select Language",english:"English",malay:"Bahasa Melayu",bengali:"à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)",close:"Close",save:"Save",requestPermit:"Request Permit",permitType:"Permit Type",location:"Location",description:"Description",duration:"Duration",riskLevel:"Risk Level",submitRequest:"Submit Request",hotWork:"Hot Work",confinedSpace:"Confined Space",electricalWork:"Electrical Work",workingAtHeight:"Working at Height",low:"Low",medium:"Medium",high:"High",myPermits:"My Permits",pending:"Pending",active:"Active",completed:"Completed",rejected:"Rejected"},malay:{digitalPassport:"Pasport Digital",scanForVerification:"Imbas untuk Pengesahan",workerInfo:"Maklumat Pekerja",role:"Peranan",department:"Jabatan",phone:"Telefon",emergency:"Kecemasan",certifications:"Sijil",sopLibrary:"Pustaka SOP",ladderSafety:"Keselamatan Tangga",craneOperations:"Operasi Kren",electricalSafety:"Keselamatan Elektrik",chemicalHandling:"Pengendalian Kimia",quickActions:"Tindakan Pantas",emergencyCall:"Panggilan Kecemasan",supervisorContact:"Hubungi Penyelia",siteMap:"Peta Tapak",redZoneAlert:"Amaran Zon Merah",playing:"Dimainkan...",paused:"Dijeda",speaking:"Bercakap...",settings:"Tetapan",language:"Bahasa",selectLanguage:"Pilih Bahasa",english:"English",malay:"Bahasa Melayu",bengali:"à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)",close:"Tutup",save:"Simpan",requestPermit:"Mohon Permit",permitType:"Jenis Permit",location:"Lokasi",description:"Keterangan",duration:"Tempoh",riskLevel:"Tahap Risiko",submitRequest:"Hantar Permohonan",hotWork:"Kerja Panas",confinedSpace:"Ruang Terhad",electricalWork:"Kerja Elektrik",workingAtHeight:"Kerja di Ketinggian",low:"Rendah",medium:"Sederhana",high:"Tinggi",myPermits:"Permit Saya",pending:"Menunggu",active:"Aktif",completed:"Selesai",rejected:"Ditolak"},bengali:{digitalPassport:"à¦¡à¦¿à¦œà¦¿à¦Ÿà¦¾à¦² à¦ªà¦¾à¦¸à¦ªà§‹à¦°à§à¦Ÿ",scanForVerification:"à¦¯à¦¾à¦šà¦¾à¦‡à¦¯à¦¼à§‡à¦° à¦œà¦¨à§à¦¯ à¦¸à§à¦•à§à¦¯à¦¾à¦¨ à¦•à¦°à§à¦¨",workerInfo:"à¦•à¦°à§à¦®à§€ à¦¤à¦¥à§à¦¯",role:"à¦­à§‚à¦®à¦¿à¦•à¦¾",department:"à¦¬à¦¿à¦­à¦¾à¦—",phone:"à¦«à§‹à¦¨",emergency:"à¦œà¦°à§à¦°à¦¿",certifications:"à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦¶à¦¨",sopLibrary:"SOP à¦²à¦¾à¦‡à¦¬à§à¦°à§‡à¦°à¦¿",ladderSafety:"à¦¸à¦¿à¦à¦¡à¦¼à¦¿ à¦¨à¦¿à¦°à¦¾à¦ªà¦¤à§à¦¤à¦¾",craneOperations:"à¦•à§à¦°à§‡à¦¨ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨",electricalSafety:"à¦¬à§ˆà¦¦à§à¦¯à§à¦¤à¦¿à¦• à¦¨à¦¿à¦°à¦¾à¦ªà¦¤à§à¦¤à¦¾",chemicalHandling:"à¦°à¦¾à¦¸à¦¾à¦¯à¦¼à¦¨à¦¿à¦• à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾",quickActions:"à¦¦à§à¦°à§à¦¤ à¦ªà¦¦à¦•à§à¦·à§‡à¦ª",emergencyCall:"à¦œà¦°à§à¦°à¦¿ à¦•à¦²",supervisorContact:"à¦¸à§à¦ªà¦¾à¦°à¦­à¦¾à¦‡à¦œà¦¾à¦° à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦—",siteMap:"à¦¸à¦¾à¦‡à¦Ÿ à¦®à§à¦¯à¦¾à¦ª",redZoneAlert:"à¦°à§‡à¦¡ à¦œà§‹à¦¨ à¦¸à¦¤à¦°à§à¦•à¦¤à¦¾",playing:"à¦šà¦²à¦›à§‡...",paused:"à¦¬à¦¿à¦°à¦¤à¦¿",speaking:"à¦•à¦¥à¦¾ à¦¬à¦²à¦›à§‡...",settings:"à¦¸à§‡à¦Ÿà¦¿à¦‚à¦¸",language:"à¦­à¦¾à¦·à¦¾",selectLanguage:"à¦­à¦¾à¦·à¦¾ à¦¨à¦¿à¦°à§à¦¬à¦¾à¦šà¦¨ à¦•à¦°à§à¦¨",english:"English",malay:"Bahasa Melayu",bengali:"à¦¬à¦¾à¦‚à¦²à¦¾",close:"à¦¬à¦¨à§à¦§ à¦•à¦°à§à¦¨",save:"à¦¸à¦‚à¦°à¦•à§à¦·à¦£ à¦•à¦°à§à¦¨",requestPermit:"à¦ªà¦¾à¦°à¦®à¦¿à¦Ÿ à¦…à¦¨à§à¦°à§‹à¦§ à¦•à¦°à§à¦¨",permitType:"à¦ªà¦¾à¦°à¦®à¦¿à¦Ÿà§‡à¦° à¦§à¦°à¦¨",location:"à¦…à¦¬à¦¸à§à¦¥à¦¾à¦¨",description:"à¦¬à¦°à§à¦£à¦¨à¦¾",duration:"à¦¸à¦®à¦¯à¦¼à¦•à¦¾à¦²",riskLevel:"à¦à§à¦à¦•à¦¿à¦° à¦¸à§à¦¤à¦°",submitRequest:"à¦…à¦¨à§à¦°à§‹à¦§ à¦œà¦®à¦¾ à¦¦à¦¿à¦¨",hotWork:"à¦—à¦°à¦® à¦•à¦¾à¦œ",confinedSpace:"à¦¸à§€à¦®à¦¿à¦¤ à¦¸à§à¦¥à¦¾à¦¨",electricalWork:"à¦¬à§ˆà¦¦à§à¦¯à§à¦¤à¦¿à¦• à¦•à¦¾à¦œ",workingAtHeight:"à¦‰à¦šà§à¦šà¦¤à¦¾à¦¯à¦¼ à¦•à¦¾à¦œ",low:"à¦¨à¦¿à¦®à§à¦¨",medium:"à¦®à¦¾à¦à¦¾à¦°à¦¿",high:"à¦‰à¦šà§à¦š",myPermits:"à¦†à¦®à¦¾à¦° à¦ªà¦¾à¦°à¦®à¦¿à¦Ÿ",pending:"à¦…à¦ªà§‡à¦•à§à¦·à¦®à¦¾à¦¨",active:"à¦¸à¦•à§à¦°à¦¿à¦¯à¦¼",completed:"à¦¸à¦®à§à¦ªà¦¨à§à¦¨",rejected:"à¦ªà§à¦°à¦¤à§à¦¯à¦¾à¦–à§à¦¯à¦¾à¦¤"},rojak:{digitalPassport:"Digital Passport / Pasport Digital",scanForVerification:"Scan for Verification / Imbas untuk Pengesahan",workerInfo:"Worker Information / Maklumat Pekerja",role:"Role / Peranan",department:"Department / Jabatan",phone:"Phone / Telefon",emergency:"Emergency / Kecemasan",certifications:"Certifications / Sijil",sopLibrary:"SOP Library / Pustaka SOP",ladderSafety:"Ladder Safety / Keselamatan Tangga",craneOperations:"Crane Operations / Operasi Kren",electricalSafety:"Electrical Safety / Keselamatan Elektrik",chemicalHandling:"Chemical Handling / Pengendalian Kimia",quickActions:"Quick Actions / Tindakan Pantas",emergencyCall:"Emergency Call / Panggilan Kecemasan",supervisorContact:"Supervisor Contact / Hubungi Penyelia",siteMap:"Site Map / Peta Tapak",redZoneAlert:"Red Zone Alert / Amaran Zon Merah",playing:"Playing... / Dimainkan...",paused:"Paused / Dijeda",speaking:"Speaking... / Bercakap...",settings:"Settings / Tetapan",language:"Language / Bahasa",selectLanguage:"Select Language / Pilih Bahasa",english:"English",malay:"Bahasa Melayu",bengali:"à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)",rojak:"Bahasa Rojak",close:"Close / Tutup",save:"Save / Simpan",requestPermit:"Request Permit / Mohon Permit",permitType:"Permit Type / Jenis Permit",location:"Location / Lokasi",description:"Description / Keterangan",duration:"Duration / Tempoh",riskLevel:"Risk Level / Tahap Risiko",submitRequest:"Submit Request / Hantar Permohonan",hotWork:"Hot Work / Kerja Panas",confinedSpace:"Confined Space / Ruang Terhad",electricalWork:"Electrical Work / Kerja Elektrik",workingAtHeight:"Working at Height / Kerja di Ketinggian",low:"Low / Rendah",medium:"Medium / Sederhana",high:"High / Tinggi",myPermits:"My Permits / Permit Saya",pending:"Pending / Menunggu",active:"Active / Aktif",completed:"Completed / Selesai",rejected:"Rejected / Ditolak"},malayPlusEnglish:{digitalPassport:"Pasport Digital",scanForVerification:"Imbas untuk Pengesahan",workerInfo:"Maklumat Pekerja",role:"Peranan",department:"Jabatan",phone:"Telefon",emergency:"Kecemasan",certifications:"Sijil",sopLibrary:"Pustaka SOP",ladderSafety:"Keselamatan Tangga",craneOperations:"Operasi Kren",electricalSafety:"Keselamatan Elektrik",chemicalHandling:"Pengendalian Kimia",quickActions:"Tindakan Pantas",emergencyCall:"Panggilan Kecemasan",supervisorContact:"Hubungi Penyelia",siteMap:"Peta Tapak",redZoneAlert:"Amaran Zon Merah",playing:"Dimainkan...",paused:"Dijeda",speaking:"Bercakap...",settings:"Tetapan",language:"Bahasa",selectLanguage:"Pilih Bahasa",english:"English",malay:"Bahasa Melayu",bengali:"à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)",close:"Tutup",save:"Simpan",requestPermit:"Mohon Permit",permitType:"Jenis Permit",location:"Lokasi",description:"Keterangan",duration:"Tempoh",riskLevel:"Tahap Risiko",submitRequest:"Hantar Permohonan",hotWork:"Kerja Panas",confinedSpace:"Ruang Terhad",electricalWork:"Kerja Elektrik",workingAtHeight:"Kerja di Ketinggian",low:"Rendah",medium:"Sederhana",high:"Tinggi",myPermits:"Permit Saya",pending:"Menunggu",active:"Aktif",completed:"Selesai",rejected:"Ditolak"}},X=Q[s]||Q.english,speakSOPContent=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";if("speechSynthesis"in window){let s;window.speechSynthesis.cancel();let a=new SpeechSynthesisUtterance(e);"bn"===t?a.lang="bn-IN":"ms"===t?a.lang="ms-MY":a.lang="en-US",a.rate=.9,a.pitch=1,a.volume=1,(s="bn"===t?P.find(e=>e.lang.includes("bn")||e.lang.includes("hi")||e.name.includes("Bengali")||e.name.includes("Hindi")):"ms"===t?P.find(e=>e.lang.includes("ms")||e.lang.includes("Malay")||e.name.includes("Malay")):P.find(e=>e.lang.includes("en")&&(e.name.includes("Female")||e.name.includes("Microsoft"))))&&(a.voice=s),a.onstart=()=>T(!0),a.onend=()=>T(!1),a.onerror=()=>T(!1),window.speechSynthesis.speak(a)}},handlePlayAudio=e=>{f(e),k(!0),C(0);let t=e.content.english,a="en";"malay"===s||"rojak"===s||"malayPlusEnglish"===s?(t=e.content.malay||e.content.english,a="ms"):"bengali"===s&&(t=e.content.bengali,a="bn"),speakSOPContent(t,a);let l=setInterval(()=>{C(t=>t>=100?(clearInterval(l),k(!1),100):t+100/e.audioDuration)},1e3)},handleLanguageChange=e=>{c(e),R(!1)},getWorkerPermits=()=>h.filter(e=>e.requester===J.name);return(0,a.jsxs)("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"mobile-frame",children:(0,a.jsxs)("div",{className:"mobile-content bg-dark-surface",children:[(0,a.jsx)("div",{className:"bg-construction-yellow text-black p-4 sticky top-0 z-10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-bold",children:X.digitalPassport}),(0,a.jsx)("p",{className:"text-xs opacity-80",children:J.name})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>R(!0),className:"p-1 hover:bg-black/10 rounded transition-colors",title:X.settings,children:(0,a.jsx)(D.Z,{className:"w-5 h-5"})}),(0,a.jsx)(x.Z,{className:"w-5 h-5"}),(0,a.jsxs)("span",{className:"text-sm font-semibold",children:[J.complianceScore,"%"]})]})]})}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-construction-yellow rounded-full flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"w-6 h-6 text-black"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-white font-semibold",children:J.name}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:J.id})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-400",children:[X.role,":"]}),(0,a.jsx)("span",{className:"text-white ml-1",children:J.role})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-400",children:[X.department,":"]}),(0,a.jsx)("span",{className:"text-white ml-1",children:J.department})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-400",children:[X.phone,":"]}),(0,a.jsx)("span",{className:"text-white ml-1",children:J.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-400",children:[X.emergency,":"]}),(0,a.jsx)("span",{className:"text-white ml-1 text-red-400",children:J.emergencyContact})]})]}),(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[(0,a.jsxs)("p",{className:"text-gray-400 text-xs mb-2",children:[X.certifications,":"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:J.certifications.map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-1 bg-construction-yellow/20 text-construction-yellow text-xs rounded-full",children:e},t))})]})]}),(0,a.jsxs)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"bg-dark-bg border border-dark-border rounded-lg p-6 text-center",children:[(0,a.jsxs)("h3",{className:"text-white font-semibold mb-4 flex items-center justify-center",children:[(0,a.jsx)(K.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),X.scanForVerification]}),(0,a.jsx)("div",{className:"w-48 h-48 mx-auto bg-white p-3 rounded-lg shadow-lg",children:G?(0,a.jsx)("img",{src:G,alt:"Worker QR Code",className:"w-full h-full rounded"}):(0,a.jsx)("div",{className:"w-full h-full bg-gray-200 rounded flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-gray-400 text-xs text-center",children:"Generating QR Code..."})})}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-3",children:["ID: ",J.id]})]}),(0,a.jsxs)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:[(0,a.jsxs)("h3",{className:"text-white font-semibold mb-3 flex items-center",children:[(0,a.jsx)(U.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),X.sopLibrary]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:[{id:"ladder",title:"Ladder Safety",icon:"\uD83E\uDE9C",color:"bg-blue-500/10 border-blue-500/30",audioDuration:45,content:{english:"Always maintain three points of contact when climbing ladders. Inspect ladder before use and ensure it is placed on stable ground.",bengali:"à¦¸à¦¿à¦à¦¡à¦¼à¦¿à¦¤à§‡ à¦‰à¦ à¦¾à¦° à¦¸à¦®à¦¯à¦¼ à¦¸à¦°à§à¦¬à¦¦à¦¾ à¦¤à¦¿à¦¨à¦Ÿà¦¿ à¦¬à¦¿à¦¨à§à¦¦à§à¦¤à§‡ à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦¬à¦œà¦¾à¦¯à¦¼ à¦°à¦¾à¦–à§à¦¨à¥¤ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à§‡à¦° à¦†à¦—à§‡ à¦¸à¦¿à¦à¦¡à¦¼à¦¿ à¦ªà¦°à¦¿à¦¦à¦°à§à¦¶à¦¨ à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à§à¦¨ à¦à¦Ÿà¦¿ à¦¸à§à¦¥à¦¿à¦¤à¦¿à¦¶à§€à¦² à¦­à§‚à¦®à¦¿à¦¤à§‡ à¦°à¦¾à¦–à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤",malay:"Sentiasa lakukan tiga titik sentuh semasa memanjat tangga. Periksa tangga sebelum digunakan dan pastikan ia diletakkan di atas tanah yang stabil."}},{id:"crane",title:"Crane Operations",icon:"\uD83C\uDFD7ï¸",color:"bg-yellow-500/10 border-yellow-500/30",audioDuration:60,content:{english:"Never exceed load capacity. Ensure all personnel are clear of the swing radius. Use proper hand signals and maintain communication.",bengali:"à¦•à¦–à¦¨à¦“ à¦²à§‹à¦¡ à¦•à§à¦·à¦®à¦¤à¦¾ à¦…à¦¤à¦¿à¦•à§à¦°à¦® à¦•à¦°à¦¬à§‡à¦¨ à¦¨à¦¾à¥¤ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à§à¦¨ à¦¸à¦®à¦¸à§à¦¤ à¦•à¦°à§à¦®à§€ à¦¸à§à¦‡à¦‚ à¦¬à§à¦¯à¦¾à¦¸à¦¾à¦°à§à¦§ à¦¥à§‡à¦•à§‡ à¦®à§à¦•à§à¦¤à¥¤ à¦¸à¦ à¦¿à¦• à¦¹à¦¾à¦¤ à¦¸à¦‚à¦•à§‡à¦¤ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦¬à¦œà¦¾à¦¯à¦¼ à¦°à¦¾à¦–à§à¦¨à¥¤",malay:"Jangan sekali-kali melebihi kapasiti muatan. Pastikan semua personel berada di luar radius ayunan. Gunakan isyarat tangan yang betul dan kekalkan komunikasi."}},{id:"electrical",title:"Electrical Safety",icon:"âš¡",color:"bg-purple-500/10 border-purple-500/30",audioDuration:55,content:{english:"Always lock out and tag out electrical equipment before servicing. Use insulated tools and wear appropriate PPE when working with electricity.",bengali:"à¦ªà¦°à¦¿à¦·à§‡à¦¬à¦¾ à¦¦à§‡à¦“à¦¯à¦¼à¦¾à¦° à¦†à¦—à§‡ à¦¸à¦°à§à¦¬à¦¦à¦¾ à¦¬à§ˆà¦¦à§à¦¯à§à¦¤à¦¿à¦• à¦¸à¦°à¦žà§à¦œà¦¾à¦® à¦²à¦• à¦†à¦‰à¦Ÿ à¦à¦¬à¦‚ à¦Ÿà§à¦¯à¦¾à¦— à¦†à¦‰à¦Ÿ à¦•à¦°à§à¦¨à¥¤ à¦¬à¦¿à¦¦à§à¦¯à§à§Ž à¦¨à¦¿à¦¯à¦¼à§‡ à¦•à¦¾à¦œ à¦•à¦°à¦¾à¦° à¦¸à¦®à¦¯à¦¼ à¦‡à¦¨à¦¸à§à¦²à§‡à¦Ÿà§‡à¦¡ à¦¸à¦°à¦žà§à¦œà¦¾à¦® à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à¦‰à¦ªà¦¯à§à¦•à§à¦¤ PPE à¦ªà¦°à§à¦¨à¥¤",malay:"Sentiasa lakukan lock out dan tag out peralatan elektrik sebelum penyelenggaraan. Gunakan alat terpenebat dan pakai PPE yang sesuai semasa bekerja dengan elektrik."}},{id:"chemicals",title:"Chemical Handling",icon:"\uD83E\uDDEA",color:"bg-green-500/10 border-green-500/30",audioDuration:50,content:{english:"Always read SDS before handling chemicals. Use proper ventilation and wear appropriate PPE including gloves and goggles.",bengali:"à¦°à¦¾à¦¸à¦¾à¦¯à¦¼à¦¨à¦¿à¦• à¦ªà¦¦à¦¾à¦°à§à¦¥ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾à¦° à¦†à¦—à§‡ à¦¸à¦°à§à¦¬à¦¦à¦¾ SDS à¦ªà¦¡à¦¼à§à¦¨à¥¤ à¦¸à¦ à¦¿à¦• à¦¬à¦¾à¦¯à¦¼à§à¦šà¦²à¦¾à¦šà¦² à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à¦—à§à¦²à¦¾à¦­à¦¸ à¦à¦¬à¦‚ à¦—à¦—à¦²à¦¸ à¦¸à¦¹ à¦‰à¦ªà¦¯à§à¦•à§à¦¤ PPE à¦ªà¦°à§à¦¨à¥¤",malay:"Sentiasa baca SDS sebelum mengendalikan bahan kimia. Gunakan pengudaraan yang betul dan pakai PPE yang sesuai termasuk sarung tangan dan gogal."}}].map(e=>(0,a.jsxs)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>handlePlayAudio(e),className:"p-4 rounded-lg border ".concat(e.color," hover:border-construction-yellow transition-all"),children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:e.icon}),(0,a.jsx)("p",{className:"text-xs text-white font-semibold",children:"english"===s?e.title:"ladder"===e.id?X.ladderSafety:"crane"===e.id?X.craneOperations:"electrical"===e.id?X.electricalSafety:X.chemicalHandling})]},e.id))})]}),(0,a.jsx)(n.M,{children:j&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h4",{className:"text-white font-semibold text-sm",children:j.title}),(0,a.jsx)("button",{onClick:v?()=>{k(!1),"speechSynthesis"in window&&(window.speechSynthesis.cancel(),T(!1))}:()=>handlePlayAudio(j),className:"p-2 bg-construction-yellow rounded-full text-black",children:v?(0,a.jsx)(Z.Z,{className:"w-4 h-4"}):(0,a.jsx)(L.Z,{className:"w-4 h-4"})})]}),(0,a.jsx)("div",{className:"w-full bg-dark-border rounded-full h-2 mb-3",children:(0,a.jsx)(i.E.div,{className:"bg-construction-yellow h-2 rounded-full",initial:{width:0},animate:{width:"".concat(S,"%")},transition:{duration:.5}})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(y.Z,{className:"w-4 h-4 text-construction-yellow ".concat(A?"animate-pulse":"")}),(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:[v?A?X.speaking:X.playing:X.paused," â€¢ ",Math.floor(S/100*j.audioDuration),"s / ",j.audioDuration,"s"]})]}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>speakSOPContent(j.content.english,"en"),className:"p-1 bg-dark-surface rounded hover:bg-dark-border transition-colors",title:"Play in English",children:(0,a.jsx)("span",{className:"text-xs text-construction-yellow",children:"EN"})}),j.content.bengali&&(0,a.jsx)("button",{onClick:()=>speakSOPContent(j.content.bengali,"bn"),className:"p-1 bg-dark-surface rounded hover:bg-dark-border transition-colors",title:"Play in Bengali",children:(0,a.jsx)("span",{className:"text-xs text-construction-yellow",children:"BN"})}),j.content.malay&&(0,a.jsx)("button",{onClick:()=>speakSOPContent(j.content.malay,"ms"),className:"p-1 bg-dark-surface rounded hover:bg-dark-border transition-colors",title:"Play in Malay",children:(0,a.jsx)("span",{className:"text-xs text-construction-yellow",children:"MY"})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"p-2 bg-dark-surface rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-300 mb-1",children:"English:"}),(0,a.jsx)("p",{className:"text-xs text-white",children:j.content.english})]}),j.content.bengali&&(0,a.jsxs)("div",{className:"p-2 bg-dark-surface rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-300 mb-1",children:"à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali):"}),(0,a.jsx)("p",{className:"text-xs text-white",children:j.content.bengali})]}),j.content.malay&&(0,a.jsxs)("div",{className:"p-2 bg-dark-surface rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-300 mb-1",children:"Bahasa Melayu:"}),(0,a.jsx)("p",{className:"text-xs text-white",children:j.content.malay})]})]})]})}),(0,a.jsxs)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"text-white font-semibold flex items-center",children:[(0,a.jsx)(W.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),X.quickActions]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{window.open("tel:".concat(J.emergencyContact))},className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg hover:bg-red-500/20 transition-all",children:[(0,a.jsx)(q.Z,{className:"w-4 h-4 text-red-400 mx-auto mb-1"}),(0,a.jsx)("span",{className:"text-xs text-red-400 block",children:X.emergencyCall})]}),(0,a.jsxs)("button",{onClick:()=>{let e=g.find(e=>"Site Supervisor"===e.role&&e.siteAssigned===J.siteAssigned);e&&window.open("tel:".concat(e.phone))},className:"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg hover:bg-blue-500/20 transition-all",children:[(0,a.jsx)(V.Z,{className:"w-4 h-4 text-blue-400 mx-auto mb-1"}),(0,a.jsx)("span",{className:"text-xs text-blue-400 block",children:X.supervisorContact})]}),(0,a.jsxs)("button",{onClick:()=>{let e=b.find(e=>e.name===J.siteAssigned);e&&window.open("https://maps.google.com/?q=".concat(e.location))},className:"p-3 bg-green-500/10 border border-green-500/30 rounded-lg hover:bg-green-500/20 transition-all",children:[(0,a.jsx)(w.Z,{className:"w-4 h-4 text-green-400 mx-auto mb-1"}),(0,a.jsx)("span",{className:"text-xs text-green-400 block",children:X.siteMap})]}),(0,a.jsxs)("button",{onClick:()=>{let e={english:"RED ZONE ALERT! Evacuate Immediately!",malay:"AMARAN ZON MERAH! Evakuasi Segera!",bengali:"à¦°à§‡à¦¡ à¦œà§‹à¦¨ à¦¸à¦¤à¦°à§à¦•à¦¤à¦¾! à¦…à¦¬à¦¿à¦²à¦®à§à¦¬à§‡ à¦¸à¦°à§‡ à¦¯à¦¾à¦¨!",rojak:"PERHATIAN! ZON MERAH TU! KELUAR CEPAT! LARI SEKARANG, JANGAN DUK SINI!",malayPlusEnglish:"AMARAN ZON MERAH! Evakuasi Segera! RED ZONE ALERT! Evacuate Immediately!"},t=e[s]||e.english;try{if("speechSynthesis"in window){window.speechSynthesis.cancel();let e=new SpeechSynthesisUtterance(t);"malay"===s||"rojak"===s||"malayPlusEnglish"===s?e.lang="ms-MY":"bengali"===s?e.lang="bn-IN":e.lang="en-US",e.rate=1.4,e.pitch=1.3,e.volume=1,window.speechSynthesis.speak(e)}}catch(e){console.log("Speech not available:",e)}alert(t)},className:"p-3 bg-orange-500/10 border border-orange-500/30 rounded-lg hover:bg-orange-500/20 transition-all",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 text-orange-400 mx-auto mb-1"}),(0,a.jsx)("span",{className:"text-xs text-orange-400 block",children:X.redZoneAlert})]})]})]}),(0,a.jsxs)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"text-white font-semibold flex items-center",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),X.myPermits]}),(0,a.jsx)("button",{onClick:()=>z(!0),className:"px-3 py-1 bg-construction-yellow text-black text-xs rounded-full hover:bg-yellow-400 transition-colors",children:X.requestPermit})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[getWorkerPermits().slice(0,3).map(e=>(0,a.jsxs)("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-white text-sm font-semibold",children:e.type}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat("active"===e.status?"bg-green-500/20 text-green-400":"pending"===e.status?"bg-yellow-500/20 text-yellow-400":"completed"===e.status?"bg-blue-500/20 text-blue-400":"bg-red-500/20 text-red-400"),children:"active"===e.status?X.active:"pending"===e.status?X.pending:"completed"===e.status?X.completed:X.rejected})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(w.Z,{className:"w-3 h-3 mr-1"}),e.location]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(N.Z,{className:"w-3 h-3 mr-1"}),e.expiry]})]})]},e.id)),0===getWorkerPermits().length&&(0,a.jsxs)("div",{className:"text-center py-4 text-gray-400 text-xs",children:["english"===s&&"No permits requested yet","malay"===s&&"Belum ada permit yang dimohon","bengali"===s&&"à¦à¦–à¦¨à¦“ à¦•à§‹à¦¨ à¦ªà¦¾à¦°à¦®à¦¿à¦Ÿ à¦…à¦¨à§à¦°à§‹à¦§ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à¦¨à¦¿","malayPlusEnglish"===s&&"Belum ada permit yang dimohon"]})]})]})]})]})}),(0,a.jsx)(n.M,{children:F&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>z(!1),children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-sm w-full max-h-[80vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-white font-semibold flex items-center",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),X.requestPermit]}),(0,a.jsx)("button",{onClick:()=>z(!1),className:"p-1 hover:bg-dark-bg rounded transition-colors",children:(0,a.jsx)(m.Z,{className:"w-4 h-4 text-gray-400"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-gray-400 text-xs block mb-1",children:X.permitType}),(0,a.jsxs)("select",{value:H.type,onChange:e=>_({...H,type:e.target.value}),className:"w-full p-2 bg-dark-bg border border-dark-border rounded text-white text-sm",children:[(0,a.jsx)("option",{value:"Hot Work",children:X.hotWork}),(0,a.jsx)("option",{value:"Confined Space",children:X.confinedSpace}),(0,a.jsx)("option",{value:"Electrical Work",children:X.electricalWork}),(0,a.jsx)("option",{value:"Working at Height",children:X.workingAtHeight})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-gray-400 text-xs block mb-1",children:X.location}),(0,a.jsx)("input",{type:"text",value:H.location,onChange:e=>_({...H,location:e.target.value}),placeholder:"english"===s?"Enter work location":"malay"===s||"malayPlusEnglish"===s?"Masukkan lokasi kerja":"à¦•à¦¾à¦œà§‡à¦° à¦¸à§à¦¥à¦¾à¦¨ à¦²à¦¿à¦–à§à¦¨",className:"w-full p-2 bg-dark-bg border border-dark-border rounded text-white text-sm placeholder-gray-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-gray-400 text-xs block mb-1",children:X.description}),(0,a.jsx)("textarea",{value:H.description,onChange:e=>_({...H,description:e.target.value}),placeholder:"english"===s?"Describe the work to be performed":"malay"===s||"malayPlusEnglish"===s?"Huraikan kerja yang akan dilakukan":"à¦¸à¦®à§à¦ªà¦¾à¦¦à¦¨ à¦•à¦°à¦¾à¦° à¦•à¦¾à¦œ à¦¬à¦°à§à¦£à¦¨à¦¾ à¦•à¦°à§à¦¨",rows:3,className:"w-full p-2 bg-dark-bg border border-dark-border rounded text-white text-sm placeholder-gray-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-gray-400 text-xs block mb-1",children:X.duration}),(0,a.jsxs)("select",{value:H.duration,onChange:e=>_({...H,duration:e.target.value}),className:"w-full p-2 bg-dark-bg border border-dark-border rounded text-white text-sm",children:[(0,a.jsx)("option",{value:"1 hour",children:"1 hour"}),(0,a.jsx)("option",{value:"2 hours",children:"2 hours"}),(0,a.jsx)("option",{value:"4 hours",children:"4 hours"}),(0,a.jsx)("option",{value:"8 hours",children:"8 hours"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-gray-400 text-xs block mb-1",children:X.riskLevel}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsx)("button",{onClick:()=>_({...H,riskLevel:"low"}),className:"p-2 rounded text-xs transition-all ".concat("low"===H.riskLevel?"bg-green-500/20 border border-green-500 text-green-400":"bg-dark-bg border border-dark-border text-gray-400 hover:border-green-500/50"),children:X.low}),(0,a.jsx)("button",{onClick:()=>_({...H,riskLevel:"medium"}),className:"p-2 rounded text-xs transition-all ".concat("medium"===H.riskLevel?"bg-yellow-500/20 border border-yellow-500 text-yellow-400":"bg-dark-bg border border-dark-border text-gray-400 hover:border-yellow-500/50"),children:X.medium}),(0,a.jsx)("button",{onClick:()=>_({...H,riskLevel:"high"}),className:"p-2 rounded text-xs transition-all ".concat("high"===H.riskLevel?"bg-red-500/20 border border-red-500 text-red-400":"bg-dark-bg border border-dark-border text-gray-400 hover:border-red-500/50"),children:X.high})]})]}),(0,a.jsx)("button",{onClick:()=>{let e={...H,requester:J.name,site:J.siteAssigned};o(e),z(!1),_({type:"Hot Work",location:"",description:"",duration:"2 hours",riskLevel:"medium"})},disabled:!H.location||!H.description,className:"w-full p-3 bg-construction-yellow text-black rounded font-semibold text-sm hover:bg-yellow-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:X.submitRequest})]})]})})}),(0,a.jsx)(n.M,{children:I&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>R(!1),children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-white font-semibold flex items-center",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),X.selectLanguage]}),(0,a.jsx)("button",{onClick:()=>R(!1),className:"p-1 hover:bg-dark-bg rounded transition-colors",children:(0,a.jsx)(m.Z,{className:"w-4 h-4 text-gray-400"})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("button",{onClick:()=>handleLanguageChange("english"),className:"w-full p-3 rounded-lg border transition-all flex items-center justify-between ".concat("english"===s?"bg-construction-yellow/20 border-construction-yellow text-construction-yellow":"bg-dark-bg border-dark-border text-white hover:border-construction-yellow/50"),children:[(0,a.jsx)("span",{children:X.english}),"english"===s&&(0,a.jsx)("div",{className:"w-2 h-2 bg-construction-yellow rounded-full"})]}),(0,a.jsxs)("button",{onClick:()=>handleLanguageChange("malay"),className:"w-full p-3 rounded-lg border transition-all flex items-center justify-between ".concat("malay"===s?"bg-construction-yellow/20 border-construction-yellow text-construction-yellow":"bg-dark-bg border-dark-border text-white hover:border-construction-yellow/50"),children:[(0,a.jsx)("span",{children:X.malay}),"malay"===s&&(0,a.jsx)("div",{className:"w-2 h-2 bg-construction-yellow rounded-full"})]}),(0,a.jsxs)("button",{onClick:()=>handleLanguageChange("bengali"),className:"w-full p-3 rounded-lg border transition-all flex items-center justify-between ".concat("bengali"===s?"bg-construction-yellow/20 border-construction-yellow text-construction-yellow":"bg-dark-bg border-dark-border text-white hover:border-construction-yellow/50"),children:[(0,a.jsx)("span",{children:X.bengali}),"bengali"===s&&(0,a.jsx)("div",{className:"w-2 h-2 bg-construction-yellow rounded-full"})]}),(0,a.jsxs)("button",{onClick:()=>handleLanguageChange("rojak"),className:"w-full p-3 rounded-lg border transition-all flex items-center justify-between ".concat("rojak"===s?"bg-construction-yellow/20 border-construction-yellow text-construction-yellow":"bg-dark-bg border-dark-border text-white hover:border-construction-yellow/50"),children:[(0,a.jsx)("span",{children:X.rojak}),"rojak"===s&&(0,a.jsx)("div",{className:"w-2 h-2 bg-construction-yellow rounded-full"})]})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-dark-bg rounded-lg",children:(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["english"===s&&"Change language to translate all text and voice instructions.","malay"===s&&"Tukar bahasa untuk menterjemah semua teks dan arahan suara.","bengali"===s&&"à¦¸à¦®à¦¸à§à¦¤ à¦ªà¦¾à¦ à§à¦¯ à¦à¦¬à¦‚ à¦­à¦¯à¦¼à§‡à¦¸ à¦¨à¦¿à¦°à§à¦¦à§‡à¦¶à¦¾à¦¬à¦²à§€ à¦…à¦¨à§à¦¬à¦¾à¦¦ à¦•à¦°à¦¤à§‡ à¦­à¦¾à¦·à¦¾ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦•à¦°à§à¦¨à¥¤","rojak"===s&&"Change language to translate all text and voice instructions. / Tukar bahasa untuk menterjemah semua teks dan arahan suara.","malayPlusEnglish"===s&&"Tukar bahasa untuk menterjemah semua teks dan arahan suara. Voice instructions will be in Malay with English text."]})})]})})})]})}function IncidentModal(){let{showModal:e,setShowModal:t,selectedIncident:s}=(0,r.useSafety)(),[c,o]=(0,l.useState)(0),[d,x]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{e&&(o(0),x(!1))},[e]),(0,l.useEffect)(()=>{let e;return d&&c<100&&(e=setInterval(()=>{o(e=>e>=100?(x(!1),100):e+20)},1e3)),()=>clearInterval(e)},[d,c]),e&&s)?(0,a.jsx)(n.M,{children:(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>t(!1),children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-white",children:"Incident Review"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Near Miss Analysis"})]}),(0,a.jsx)("button",{onClick:()=>t(!1),className:"p-2 hover:bg-dark-bg rounded-lg transition-colors",children:(0,a.jsx)(m.Z,{className:"w-5 h-5 text-gray-400"})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-dark-bg rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-white font-semibold mb-3",children:"Incident Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Type:"}),(0,a.jsx)("span",{className:"text-white ml-2 capitalize",children:s.type.replace("_"," ")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Severity:"}),(0,a.jsx)("span",{className:"text-white ml-2 capitalize",children:s.severity})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Location:"}),(0,a.jsx)("span",{className:"text-white ml-2",children:s.location})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Time:"}),(0,a.jsx)("span",{className:"text-white ml-2",children:s.time})]})]}),(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Description:"}),(0,a.jsx)("p",{className:"text-white mt-1",children:s.title})]})]}),(0,a.jsxs)("div",{className:"bg-dark-bg rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-white font-semibold mb-3",children:"Evidence"}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("div",{className:"relative rounded-lg overflow-hidden bg-gray-800 h-48 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(F.Z,{className:"w-12 h-12 text-gray-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Incident Scene Image"}),(0,a.jsxs)("p",{className:"text-gray-500 text-xs mt-1",children:["Captured at ",s.time]})]})})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-white font-medium mb-2 flex items-center",children:[(0,a.jsx)(L.Z,{className:"w-4 h-4 mr-2 text-construction-yellow"}),"Z.AI Video Analysis (5s)"]}),(0,a.jsxs)("div",{className:"relative rounded-lg overflow-hidden bg-black h-32",children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-construction-yellow rounded-full flex items-center justify-center mb-2",children:(0,a.jsx)(L.Z,{className:"w-8 h-8 text-black"})}),(0,a.jsx)("p",{className:"text-white text-sm",children:"AI-Enhanced Video"})]})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black/50 p-2",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{x(!d)},className:"p-1 bg-construction-yellow rounded text-black",children:d?(0,a.jsx)(Z.Z,{className:"w-3 h-3"}):(0,a.jsx)(L.Z,{className:"w-3 h-3"})}),(0,a.jsx)("div",{className:"flex-1 bg-gray-700 rounded-full h-1",children:(0,a.jsx)(i.E.div,{className:"bg-construction-yellow h-1 rounded-full",initial:{width:0},animate:{width:"".concat(c,"%")},transition:{duration:.5}})}),(0,a.jsxs)("span",{className:"text-xs text-white",children:[Math.floor(c/20)," / 5s"]})]})})]})]})]}),(0,a.jsxs)("div",{className:"bg-dark-bg rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-white font-semibold mb-3",children:"Z.AI Analysis"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full mt-1.5"}),(0,a.jsx)("p",{className:"text-gray-300",children:"No immediate safety hazards detected in the vicinity."})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full mt-1.5"}),(0,a.jsx)("p",{className:"text-gray-300",children:"Scaffolding instability identified as root cause."})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full mt-1.5"}),(0,a.jsx)("p",{className:"text-gray-300",children:"Recommendation: Immediate inspection of all scaffolding structures."})]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{className:"flex-1 py-2 px-4 bg-construction-yellow text-black rounded-lg font-semibold hover:bg-yellow-400 transition-colors",children:"Mark as Resolved"}),(0,a.jsx)("button",{className:"flex-1 py-2 px-4 bg-dark-bg text-white rounded-lg font-semibold border border-dark-border hover:bg-gray-800 transition-colors",children:"Schedule Follow-up"}),(0,a.jsx)("button",{onClick:()=>{try{let e=new T.ZP;e.setFont("helvetica"),e.setFontSize(20),e.setTextColor(255,184,0),e.text("INCIDENT DETAILED REPORT",105,20,{align:"center"}),e.setFontSize(12),e.setTextColor(255,255,255),e.text("Incident Details:",20,40),e.setFontSize(10),e.setTextColor(200,200,200),e.text("Type: ".concat(s.type.replace("_"," ").toUpperCase()),20,50),e.text("Severity: ".concat(s.severity.toUpperCase()),20,60),e.text("Location: ".concat(s.location),20,70),e.text("Time: ".concat(s.time),20,80),e.text("Date: ".concat(s.date||new Date().toISOString().split("T")[0]),20,90),e.text("Status: ".concat(s.status.replace("_"," ").toUpperCase()),20,100),s.reportedBy&&e.text("Reported By: ".concat(s.reportedBy),20,110),e.setFontSize(12),e.setTextColor(255,255,255),e.text("Description:",20,130),e.setFontSize(10),e.setTextColor(200,200,200);let t=s.description||s.title,a=e.splitTextToSize(t,170);e.text(a,20,140);let l=140+7*a.length+10;if("near_miss"===s.type){let t=s.costSaved||Math.floor(1e5*Math.random())+1e4,a=s.potentialCost||t;e.setFontSize(12),e.setTextColor(255,255,255),e.text("Cost Analysis:",20,l),e.setFontSize(10),e.setTextColor(200,200,200),e.text("Potential Cost if Accident Occurred: RM ".concat(a.toLocaleString()),20,l+10),e.setTextColor(0,255,0),e.text("Cost Saved by Prevention: RM ".concat(t.toLocaleString()),20,l+20),e.setDrawColor(255,184,0),e.setLineWidth(.5),e.rect(15,l-5,180,35),l+=50}e.setFontSize(12),e.setTextColor(255,255,255),e.text("Z.AI Analysis:",20,l),e.setFontSize(10),e.setTextColor(200,200,200),["No immediate safety hazards detected in the vicinity.","Scaffolding instability identified as root cause.","Recommendation: Immediate inspection of all scaffolding structures."].forEach((t,s)=>{let a=e.splitTextToSize("".concat(s+1,". ").concat(t),170);e.text(a,20,l+10+15*s)}),l+=60,e.setFontSize(8),e.setTextColor(150,150,150),e.text("Generated by SafeSite AI - YTL AI Labs",105,280,{align:"center"}),e.text("Generated on: ".concat(new Date().toLocaleString()),105,285,{align:"center"});let i=s.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),n=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);e.save("incident-detailed-".concat(i,"-").concat(n,".pdf"))}catch(e){console.error("Error generating incident PDF:",e),alert("Failed to generate incident PDF. Please try again.")}},className:"py-2 px-4 bg-dark-bg text-white rounded-lg border border-dark-border hover:bg-gray-800 transition-colors",title:"Download Detailed Report",children:(0,a.jsx)(S.Z,{className:"w-4 h-4"})})]})]})]})})}):null}function ViolationAlert(){let{showAlert:e,alertMessage:t,alertViolationType:s,setShowAlert:c,selectedLanguage:o,getTranslatedText:d}=(0,r.useSafety)(),[x,h]=(0,l.useState)(!1),[u,g]=(0,l.useState)([]),[b,f]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let loadVoices=()=>{let e=window.speechSynthesis.getVoices();g(e),console.log("Available voices:",e.map(e=>"".concat(e.name," (").concat(e.lang,")")))};loadVoices(),void 0!==window.speechSynthesis.onvoiceschanged&&(window.speechSynthesis.onvoiceschanged=loadVoices)},[]);let playAlertSound=()=>{try{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),s=e.createGain();t.connect(s),s.connect(e.destination),t.frequency.value=800,t.type="sine",s.gain.setValueAtTime(.3,e.currentTime),s.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),t.start(e.currentTime),t.stop(e.currentTime+.5),setTimeout(()=>{let t=e.createOscillator(),s=e.createGain();t.connect(s),s.connect(e.destination),t.frequency.value=800,t.type="sine",s.gain.setValueAtTime(.3,e.currentTime),s.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),t.start(e.currentTime),t.stop(e.currentTime+.5)},200)}catch(e){console.log("Audio playback not supported:",e)}},extractWorkerInfo=e=>{let t=e.match(/Worker:\s*([A-Za-z]+)/);return t?t[1]:"Unknown"},speakAlertMessage=e=>{console.log("ViolationAlert - speakAlertMessage called with:",e),console.log("ViolationAlert - selectedLanguage:",o),"speechSynthesis"in window&&(window.speechSynthesis.cancel(),setTimeout(()=>{if("speaking"===window.speechSynthesis.pendingStatus){window.speechSynthesis.cancel(),setTimeout(()=>speakAlertMessageInternal(e,o,s),200);return}speakAlertMessageInternal(e,o,s)},100))},speakAlertMessageInternal=(e,t,a)=>{let l;let i=new SpeechSynthesisUtterance;if("malay"===o){let t=e;if(e.includes("WARNING:")||e.includes("Unhooked")||e.includes("Unauthorized")){let a=e.match(/Worker:\s*([A-Za-z\s]+)/),l=a?a[1].trim():"Unknown";"UNHOOKED HARNESS"===s?t="AMARAN: Tali pinggang keselamatan tidak dipasang. (Worker: "+l+")":"NO HELMET"===s?t="AMARAN: Topi keselamatan tidak dipakai. (Worker: "+l+")":"UNAUTHORIZED ACCESS"===s&&(t="AMARAN: Akses tanpa kebenaran ke kawasan terhad. (Worker: "+l+")")}i.text=t,i.lang="ms-MY",i.rate=.9,i.pitch=1.1}else if("rojak"===o){let t=e.match(/Worker:\s*([A-Za-z\s]+)/),a=t?t[1].trim():"Rahman",l="";l="UNHOOKED HARNESS"===s?"Woi ".concat(a,"! Tali safety tak pasang lagi ke? Alamak, gila bahaya weh! Cepat pasang la, nanti terjun dari atas! Jangan gila-gila dah!"):"NO HELMET"===s?"Eh ".concat(a,"! Topi kepala tak pakai pulak? Kau nak mampus ke? Kepala kau hancur nanti kalau kena batu! Cepat pakai, jangan bodoh!"):"UNAUTHORIZED ACCESS"===s?"Hei ".concat(a,"! Apa hal kau masuk sini? Ini kawasan privet la weh! Keluar cepat sebelum aku panggil guard! Jangan jaga muka je!"):"Woi ".concat(a,"! Perhatian sikit la! Bahaya gila kat sini! Jangan jadi hero, ikut je peraturan!"),i.text=l,i.lang="ms-MY",i.rate=1.1,i.pitch=1.2,i.volume=1,console.log("ViolationAlert - Rojak message (working version):",l),console.log("ViolationAlert - Violation type:",s)}else i.text=e,i.lang="en-US",i.rate=1.2,i.pitch=1.2;i.volume=1;let n=u.length>0?u:window.speechSynthesis.getVoices();"malay"===t||"rojak"===t?(l=n.find(e=>e.lang.includes("ms")||e.lang.includes("id")||e.name.includes("Malay")||e.name.includes("Indonesian")||e.name.includes("Malaysia")))||(l=n.find(e=>e.lang.includes("en")&&(e.name.includes("Female")||e.name.includes("Microsoft")))):l=n.find(e=>e.name.includes("Female")||e.name.includes("Samantha")||e.name.includes("Karen")||e.name.includes("Zira")||e.name.includes("Microsoft Hazel")||e.name.includes("Microsoft Zira")||e.lang.includes("en")&&e.name.includes("Microsoft")),l?(i.voice=l,console.log("Using voice:",l.name,"Language:",l.lang,"Selected Language:",t)):console.log("No preferred voice found, using default"),i.onstart=()=>{console.log("Speech started for",t,":",i.text),console.log("Speech settings - lang:",i.lang,"rate:",i.rate,"pitch:",i.pitch),h(!0)},i.onend=()=>{console.log("Speech completed for",t),h(!1)},i.onerror=e=>{console.error("Speech error for",t,":",e),console.error("Error details:",e.error,e.message),h(!1),e.hasRetried||(e.hasRetried=!0,setTimeout(()=>{console.log("Retrying speech for",t),window.speechSynthesis.speak(i)},500))},window.speechSynthesis.speaking?(window.speechSynthesis.cancel(),setTimeout(()=>{console.log("About to speak:",i.text),window.speechSynthesis.speak(i)},200)):(console.log("About to speak:",i.text),window.speechSynthesis.speak(i))};return(0,l.useEffect)(()=>{if(e){playAlertSound(),speakAlertMessage(t);let e=setTimeout(()=>{c(!1)},6e3);return()=>{clearTimeout(e),"speechSynthesis"in window&&window.speechSynthesis.cancel()}}},[e,c,t,o]),(0,a.jsx)(n.M,{children:e&&(0,a.jsx)(i.E.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1,transition:{type:"spring",stiffness:300,damping:20}},exit:{scale:0,opacity:0,transition:{duration:.2}},className:"alert-popup fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[9999]",children:(0,a.jsxs)("div",{className:"bg-red-600 border-4 border-red-400 rounded-lg shadow-2xl min-w-[400px] max-w-[600px] animate-vibrate",children:[(0,a.jsxs)("div",{className:"bg-red-700 px-6 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(i.E.div,{animate:{rotate:[0,10,-10,0]},transition:{repeat:1/0,duration:.5},children:(0,a.jsx)(p.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-white",children:"SAFETY VIOLATION"}),(0,a.jsx)("p",{className:"text-red-200 text-sm",children:"Immediate Action Required"})]})]}),(0,a.jsx)("button",{onClick:()=>c(!1),className:"p-2 hover:bg-red-800 rounded-lg transition-colors",children:(0,a.jsx)(m.Z,{className:"w-5 h-5 text-white"})})]}),(0,a.jsx)("div",{className:"px-6 py-4 bg-red-600",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(y.Z,{className:"w-6 h-6 text-white mt-1 animate-pulse"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("p",{className:"text-white text-lg font-semibold leading-relaxed",children:t})})]})}),(0,a.jsxs)("div",{className:"bg-red-700 px-6 py-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-white rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-white text-sm font-semibold",children:"LIVE ALERT"}),x&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-yellow-300",children:[(0,a.jsx)(j.Z,{className:"w-3 h-3 animate-pulse"}),(0,a.jsx)("span",{className:"text-xs",children:"Speaking..."})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>{let e=extractWorkerInfo(t);f(!0),console.log("Calling worker: ".concat(e)),setTimeout(()=>{f(!1),console.log("Call ended with worker: ".concat(e))},3e3)},disabled:b,className:"p-2 rounded transition-colors flex items-center space-x-1 ".concat(b?"bg-green-600 cursor-not-allowed":"bg-green-500 hover:bg-green-600"),title:b?"Calling...":"Call Worker",children:[(0,a.jsx)(q.Z,{className:"w-4 h-4 text-white ".concat(b?"animate-pulse":"")}),(0,a.jsx)("span",{className:"text-white text-xs",children:b?"Calling...":"Call"})]}),(0,a.jsx)("button",{onClick:()=>speakAlertMessage(t),className:"p-1 hover:bg-red-600 rounded transition-colors",title:"Repeat Message",children:(0,a.jsx)(j.Z,{className:"w-4 h-4 text-white ".concat(x?"animate-pulse":"")})}),(0,a.jsx)("div",{className:"text-white text-sm",children:new Date().toLocaleTimeString()})]})]}),(0,a.jsx)("div",{className:"absolute inset-0 border-4 border-red-400 rounded-lg pointer-events-none",children:(0,a.jsx)(i.E.div,{className:"absolute inset-0 border-4 border-red-300 rounded-lg",animate:{scale:[1,1.05,1],opacity:[1,.5,1]},transition:{repeat:1/0,duration:1,ease:"easeInOut"}})})]})})})}var _=s(5589),G=s(7216),Y=s(1981);function LoginPage(){let{login:e,mockUsers:t}=(0,r.useSafety)(),[s,n]=(0,l.useState)({username:"",password:"",role:"manager"}),[m,h]=(0,l.useState)(!1),[u,g]=(0,l.useState)(""),[p,b]=(0,l.useState)(!1),handleInputChange=e=>{let{name:t,value:s}=e.target;n(e=>({...e,[t]:s})),g("")},handleSubmit=async t=>{t.preventDefault(),b(!0),g(""),setTimeout(()=>{let t=e(s.username,s.password,s.role);t.success||g(t.error),b(!1)},1e3)},fillDemoCredentials=e=>{let s=t.find(t=>t.role===e);s&&(n({username:s.username,password:s.password,role:s.role}),g(""))},getRoleIcon=e=>{switch(e){case"manager":return(0,a.jsx)(c.Z,{className:"w-5 h-5"});case"supervisor":return(0,a.jsx)(o.Z,{className:"w-5 h-5"});default:return(0,a.jsx)(d.Z,{className:"w-5 h-5"})}},getRoleColor=e=>{switch(e){case"manager":return"text-blue-400 border-blue-400/30";case"supervisor":return"text-green-400 border-green-400/30";case"worker":return"text-yellow-400 border-yellow-400/30";default:return"text-gray-400 border-gray-400/30"}};return(0,a.jsx)("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(i.E.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"w-20 h-20 bg-construction-yellow rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(x.Z,{className:"w-12 h-12 text-black"})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"SafeSite AI"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Construction Safety Ecosystem"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Powered by YTL AI Cloud"})]}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-dark-surface border border-dark-border rounded-2xl p-6 shadow-2xl",children:[(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Your Role"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["manager","supervisor","worker"].map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>n(t=>({...t,role:e})),className:"p-3 rounded-lg border transition-all flex flex-col items-center space-y-1 ".concat(s.role===e?getRoleColor(e):"border-dark-border text-gray-400 hover:border-gray-600"),children:[getRoleIcon(e),(0,a.jsx)("span",{className:"text-xs capitalize",children:e})]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",name:"username",value:s.username,onChange:handleInputChange,required:!0,className:"w-full pl-10 pr-4 py-3 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"Enter your username"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(_.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:m?"text":"password",name:"password",value:s.password,onChange:handleInputChange,required:!0,className:"w-full pl-10 pr-12 py-3 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"Enter your password"}),(0,a.jsx)("button",{type:"button",onClick:()=>h(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white transition-colors",children:m?(0,a.jsx)(G.Z,{className:"w-4 h-4"}):(0,a.jsx)(F.Z,{className:"w-4 h-4"})})]})]}),u&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center space-x-2 p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:[(0,a.jsx)(Y.Z,{className:"w-4 h-4 text-red-400"}),(0,a.jsx)("span",{className:"text-sm text-red-400",children:u})]}),(0,a.jsx)("button",{type:"submit",disabled:p,className:"w-full py-3 bg-construction-yellow text-black font-semibold rounded-lg hover:bg-yellow-400 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Signing In...":"Sign In"})]}),(0,a.jsxs)("div",{className:"mt-6 pt-6 border-t border-dark-border",children:[(0,a.jsx)("p",{className:"text-sm text-gray-400 mb-3 text-center",children:"Quick Demo Access"}),(0,a.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,a.jsx)("button",{onClick:()=>fillDemoCredentials(e.role),className:"w-full p-2 bg-dark-bg border border-dark-border rounded-lg hover:border-construction-yellow transition-all text-left",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[getRoleIcon(e.role),(0,a.jsx)("span",{className:"text-sm text-white capitalize",children:e.role})]}),(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:[e.username," / ",e.password]})]})},e.id))})]})]}),(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-center mt-6",children:(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Secure Login â€¢ End-to-End Encryption"})})]})})}var J=s(1295),Q=s(8203),X=s(9617),$=s(5367);function WorkerManagementModal(){let{workers:e,addWorker:t,updateWorker:s,deleteWorker:c,sites:o,showWorkerModal:h,setShowWorkerModal:u}=(0,r.useSafety)(),[g,p]=(0,l.useState)("list"),[b,y]=(0,l.useState)(null),[j,f]=(0,l.useState)({name:"",role:"",department:"",phone:"",email:"",certifications:[],siteAssigned:""}),resetForm=()=>{f({name:"",role:"",department:"",phone:"",email:"",certifications:[],siteAssigned:""}),y(null)},handleInputChange=e=>{let{name:t,value:s}=e.target;f(e=>({...e,[t]:s}))},handleCertificationToggle=e=>{f(t=>({...t,certifications:t.certifications.includes(e)?t.certifications.filter(t=>t!==e):[...t.certifications,e]}))},handleEdit=e=>{y(e),f({name:e.name,role:e.role,department:e.department,phone:e.phone,email:e.email,certifications:e.certifications,siteAssigned:e.siteAssigned}),p("form")},handleDelete=e=>{confirm("Are you sure you want to delete this worker?")&&c(e)},getStatusColor=e=>{switch(e){case"active":return"text-green-400 bg-green-400/10";case"on_leave":return"text-yellow-400 bg-yellow-400/10";case"inactive":return"text-red-400 bg-red-400/10";default:return"text-gray-400 bg-gray-400/10"}};return h?(0,a.jsx)(n.M,{children:(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>u(!1),children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-dark-surface border border-dark-border rounded-lg max-w-6xl w-full max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(d.Z,{className:"w-6 h-6 text-construction-yellow"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-white",children:"Worker Management"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Manage your workforce"})]})]}),(0,a.jsx)("button",{onClick:()=>{u(!1),resetForm(),p("list")},className:"p-2 hover:bg-dark-bg rounded-lg transition-colors",children:(0,a.jsx)(m.Z,{className:"w-5 h-5 text-gray-400"})})]}),(0,a.jsxs)("div",{className:"flex border-b border-dark-border",children:[(0,a.jsxs)("button",{onClick:()=>{p("list"),resetForm()},className:"flex-1 py-3 px-4 font-semibold transition-colors ".concat("list"===g?"text-construction-yellow border-b-2 border-construction-yellow":"text-gray-400 hover:text-white"),children:["Worker List (",e.length,")"]}),(0,a.jsx)("button",{onClick:()=>p("form"),className:"flex-1 py-3 px-4 font-semibold transition-colors ".concat("form"===g?"text-construction-yellow border-b-2 border-construction-yellow":"text-gray-400 hover:text-white"),children:b?"Edit Worker":"Add New Worker"})]}),(0,a.jsxs)("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 200px)"},children:["list"===g&&(0,a.jsx)("div",{className:"space-y-4",children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(d.Z,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-400",children:"No workers added yet"}),(0,a.jsx)("button",{onClick:()=>p("form"),className:"mt-4 px-4 py-2 bg-construction-yellow text-black rounded-lg font-semibold hover:bg-yellow-400 transition-colors",children:"Add First Worker"})]}):(0,a.jsx)("div",{className:"grid gap-4",children:e.map(e=>(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.name}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(getStatusColor(e.status)),children:e.status.replace("_"," ").toUpperCase()})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-300 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsx)("span",{children:e.employeeId})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsx)("span",{children:e.role})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(J.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsx)("span",{children:e.email})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(q.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsx)("span",{children:e.phone})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Q.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsxs)("span",{children:["Joined: ",e.joinDate]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsx)("span",{children:e.siteAssigned})]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.certifications.map((e,t)=>(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-construction-yellow/20 text-construction-yellow rounded",children:e},t))})]}),(0,a.jsxs)("div",{className:"flex space-x-2 ml-4",children:[(0,a.jsx)("button",{onClick:()=>handleEdit(e),className:"p-2 text-blue-400 hover:bg-blue-400/10 rounded-lg transition-colors",children:(0,a.jsx)(X.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>handleDelete(e.id),className:"p-2 text-red-400 hover:bg-red-400/10 rounded-lg transition-colors",children:(0,a.jsx)($.Z,{className:"w-4 h-4"})})]})]})},e.id))})}),"form"===g&&(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b?s(b.id,j):t(j),resetForm(),p("list")},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name *"}),(0,a.jsx)("input",{type:"text",name:"name",value:j.name,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"Enter worker's full name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Role *"}),(0,a.jsx)("input",{type:"text",name:"role",value:j.role,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"e.g., Construction Worker, Electrician"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Department *"}),(0,a.jsx)("input",{type:"text",name:"department",value:j.department,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"e.g., Structural Works, Electrical"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email *"}),(0,a.jsx)("input",{type:"email",name:"email",value:j.email,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"worker@example.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone *"}),(0,a.jsx)("input",{type:"tel",name:"phone",value:j.phone,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"+6012-345-6789"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Assigned Site *"}),(0,a.jsxs)("select",{name:"siteAssigned",value:j.siteAssigned,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-construction-yellow transition-colors",children:[(0,a.jsx)("option",{value:"",children:"Select a site"}),o.filter(e=>"active"===e.status).map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Certifications"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:["PPE Certified","Height Safety","First Aid","Electrical Safety","Confined Space","Crane Operation","Rigging","Signal Person","Welding","Scaffolding"].map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2 p-2 bg-dark-bg border border-dark-border rounded-lg cursor-pointer hover:border-construction-yellow transition-colors",children:[(0,a.jsx)("input",{type:"checkbox",checked:j.certifications.includes(e),onChange:()=>handleCertificationToggle(e),className:"w-4 h-4 text-construction-yellow bg-dark-bg border-dark-border rounded focus:ring-construction-yellow"}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:e})]},e))})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",className:"flex-1 py-2 px-4 bg-construction-yellow text-black font-semibold rounded-lg hover:bg-yellow-400 transition-colors",children:b?"Update Worker":"Add Worker"}),(0,a.jsx)("button",{type:"button",onClick:()=>{resetForm(),p("list")},className:"flex-1 py-2 px-4 bg-dark-bg text-white font-semibold border border-dark-border rounded-lg hover:bg-gray-800 transition-colors",children:"Cancel"})]})]})]})]})})}):null}var ee=s(6357);function SiteManagementModal(){let{sites:e,addSite:t,updateSite:s,deleteSite:c,workers:o,showSiteModal:d,setShowSiteModal:x}=(0,r.useSafety)(),[h,u]=(0,l.useState)("list"),[g,b]=(0,l.useState)(null),[y,j]=(0,l.useState)({name:"",location:"",projectType:"",client:"",supervisor:"",status:"active",area:"",description:"",hazards:[],startDate:"",expectedCompletion:"",scannedMap:null}),resetForm=()=>{j({name:"",location:"",projectType:"",client:"",supervisor:"",status:"active",area:"",description:"",hazards:[],startDate:"",expectedCompletion:"",scannedMap:null}),b(null)},handleInputChange=e=>{let{name:t,value:s}=e.target;j(e=>({...e,[t]:s}))},handleHazardToggle=e=>{j(t=>({...t,hazards:t.hazards.includes(e)?t.hazards.filter(t=>t!==e):[...t.hazards,e]}))},handleEdit=e=>{b(e),j({name:e.name,location:e.location,projectType:e.projectType||"",client:e.client||"",supervisor:e.supervisor,status:e.status,area:e.area,description:e.description,hazards:e.hazards||[],startDate:e.startDate||"",expectedCompletion:e.expectedCompletion||"",scannedMap:e.scannedMap||null}),u("form")},handleDelete=e=>{confirm("Are you sure you want to delete this site?")&&c(e)},getStatusColor=e=>{switch(e){case"active":return"text-green-400 bg-green-400/10";case"maintenance":return"text-yellow-400 bg-yellow-400/10";case"inactive":return"text-red-400 bg-red-400/10";default:return"text-gray-400 bg-gray-400/10"}},getWorkersCount=e=>o.filter(t=>t.siteAssigned===e).length;return d?(0,a.jsx)(n.M,{children:(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>x(!1),children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-dark-surface border border-dark-border rounded-lg max-w-6xl w-full max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(A.Z,{className:"w-6 h-6 text-construction-yellow"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-white",children:"Site Management"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Manage construction sites"})]})]}),(0,a.jsx)("button",{onClick:()=>{x(!1),resetForm(),u("list")},className:"p-2 hover:bg-dark-bg rounded-lg transition-colors",children:(0,a.jsx)(m.Z,{className:"w-5 h-5 text-gray-400"})})]}),(0,a.jsxs)("div",{className:"flex border-b border-dark-border",children:[(0,a.jsxs)("button",{onClick:()=>{u("list"),resetForm()},className:"flex-1 py-3 px-4 font-semibold transition-colors ".concat("list"===h?"text-construction-yellow border-b-2 border-construction-yellow":"text-gray-400 hover:text-white"),children:["Site List (",e.length,")"]}),(0,a.jsx)("button",{onClick:()=>u("form"),className:"flex-1 py-3 px-4 font-semibold transition-colors ".concat("form"===h?"text-construction-yellow border-b-2 border-construction-yellow":"text-gray-400 hover:text-white"),children:g?"Edit Site":"Add New Site"})]}),(0,a.jsxs)("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 200px)"},children:["list"===h&&(0,a.jsx)("div",{className:"space-y-4",children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(A.Z,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-400",children:"No sites added yet"}),(0,a.jsx)("button",{onClick:()=>u("form"),className:"mt-4 px-4 py-2 bg-construction-yellow text-black rounded-lg font-semibold hover:bg-yellow-400 transition-colors",children:"Add First Site"})]}):(0,a.jsx)("div",{className:"grid gap-4",children:e.map(e=>(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.name}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(getStatusColor(e.status)),children:e.status.toUpperCase()})]}),(0,a.jsx)("p",{className:"text-gray-300 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm text-gray-300 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(w.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsx)("span",{children:e.location})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsxs)("span",{children:[getWorkersCount(e.name)," Workers"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(ee.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsx)("span",{children:e.area})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsxs)("span",{children:["Supervisor: ",e.supervisor]})]}),e.projectType&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsx)("span",{children:e.projectType})]}),e.client&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Client:"}),(0,a.jsx)("span",{children:e.client})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Q.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsxs)("span",{children:["Last Inspection: ",e.lastInspection]})]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.hazards.map((e,t)=>(0,a.jsxs)("span",{className:"text-xs px-2 py-1 bg-red-400/20 text-red-400 rounded flex items-center space-x-1",children:[(0,a.jsx)(p.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:e})]},t))})]}),(0,a.jsxs)("div",{className:"flex space-x-2 ml-4",children:[(0,a.jsx)("button",{onClick:()=>handleEdit(e),className:"p-2 text-blue-400 hover:bg-blue-400/10 rounded-lg transition-colors",children:(0,a.jsx)(X.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>handleDelete(e.id),className:"p-2 text-red-400 hover:bg-red-400/10 rounded-lg transition-colors",children:(0,a.jsx)($.Z,{className:"w-4 h-4"})})]})]})},e.id))})}),"form"===h&&(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a={...y,workersCount:g?g.workersCount:0,lastInspection:new Date().toISOString().split("T")[0]};g?s(g.id,a):t(a),resetForm(),u("list")},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Project Name *"}),(0,a.jsx)("input",{type:"text",name:"name",value:y.name,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"e.g., Kuala Lumpur Tower Project"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Project Location *"}),(0,a.jsx)("input",{type:"text",name:"location",value:y.location,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"e.g., Jalan Tun Razak, KL"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Project Type"}),(0,a.jsxs)("select",{name:"projectType",value:y.projectType,onChange:handleInputChange,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",children:[(0,a.jsx)("option",{value:"",children:"Select Project Type"}),(0,a.jsx)("option",{value:"High-rise Building",children:"High-rise Building"}),(0,a.jsx)("option",{value:"Infrastructure",children:"Infrastructure"}),(0,a.jsx)("option",{value:"Industrial",children:"Industrial"}),(0,a.jsx)("option",{value:"Residential",children:"Residential"}),(0,a.jsx)("option",{value:"Commercial",children:"Commercial"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Client"}),(0,a.jsx)("input",{type:"text",name:"client",value:y.client,onChange:handleInputChange,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"e.g., Mega Construction Corp"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Site Supervisor *"}),(0,a.jsx)("input",{type:"text",name:"supervisor",value:y.supervisor,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"e.g., Chong Wei Ming"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),(0,a.jsxs)("select",{name:"status",value:y.status,onChange:handleInputChange,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",children:[(0,a.jsx)("option",{value:"active",children:"Active"}),(0,a.jsx)("option",{value:"maintenance",children:"Maintenance"}),(0,a.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),(0,a.jsx)("input",{type:"date",name:"startDate",value:y.startDate,onChange:handleInputChange,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-construction-yellow transition-colors [&::-webkit-calendar-picker-indicator]:filter [&::-webkit-calendar-picker-indicator]:invert"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Expected Completion"}),(0,a.jsx)("input",{type:"date",name:"expectedCompletion",value:y.expectedCompletion,onChange:handleInputChange,min:y.startDate,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-construction-yellow transition-colors [&::-webkit-calendar-picker-indicator]:filter [&::-webkit-calendar-picker-indicator]:invert"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Area *"}),(0,a.jsx)("input",{type:"text",name:"area",value:y.area,onChange:handleInputChange,required:!0,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"e.g., 15000 sqm"})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Project Description *"}),(0,a.jsx)("textarea",{name:"description",value:y.description,onChange:handleInputChange,required:!0,rows:3,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-construction-yellow transition-colors",placeholder:"Brief description of the project..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Potential Hazards"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:["Working at Height","Crane Operations","Concrete Pouring","Marine Construction","Heavy Machinery","Welding","Chemical Storage","Forklift Operation","Electrical Work","Excavation","Confined Space","Hot Work"].map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2 p-2 bg-dark-bg border border-dark-border rounded-lg cursor-pointer hover:border-construction-yellow transition-colors",children:[(0,a.jsx)("input",{type:"checkbox",checked:y.hazards.includes(e),onChange:()=>handleHazardToggle(e),className:"w-4 h-4 text-construction-yellow bg-dark-bg border-dark-border rounded focus:ring-construction-yellow"}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:e})]},e))})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Z.AI CCTV Map Scan"}),(0,a.jsx)("div",{className:"border-2 border-dashed border-dark-border rounded-lg p-6 text-center hover:border-construction-yellow transition-colors",children:y.scannedMap?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-24 h-24 mx-auto bg-construction-yellow/20 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-12 h-12 text-construction-yellow",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,a.jsx)("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"Z.AI Scanned"})]}),(0,a.jsxs)("div",{className:"text-left space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-green-400",children:y.scannedMap.aiAnalysis}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 space-y-1",children:[(0,a.jsxs)("p",{children:["\uD83D\uDCC5 Scan Time: ",y.scannedMap.scanTime]}),(0,a.jsxs)("p",{children:["\uD83C\uDFAF Confidence: ",y.scannedMap.confidence,"%"]}),(0,a.jsxs)("p",{children:["âš ï¸ Hazards Detected: ",y.scannedMap.detectedHazards]}),(0,a.jsxs)("p",{children:["\uD83C\uDD94 Scan ID: ",y.scannedMap.scanId]})]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>j(e=>({...e,scannedMap:null})),className:"text-red-400 hover:text-red-300 text-sm",children:"Remove Scan"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 mx-auto bg-construction-yellow/20 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-construction-yellow",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:"Trigger Z.AI integrated CCTV scan"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"AI will automatically scan and analyze the current site map from CCTV feeds"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{j(e=>({...e,scannedMap:{processed:!0,aiAnalysis:"Site map is scanned and uploaded by AI integrated CCTV. Key areas and hazards have been automatically identified.",scanTime:new Date().toLocaleString(),confidence:98.5,detectedHazards:e.hazards.length,scanId:"SCAN-".concat(Date.now())}}))},className:"px-4 py-2 bg-construction-yellow text-black rounded-lg font-semibold hover:bg-yellow-400 transition-colors inline-block",children:"\uD83C\uDFA5 Start AI Scan"})]})})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",className:"flex-1 py-2 px-4 bg-construction-yellow text-black font-semibold rounded-lg hover:bg-yellow-400 transition-colors",children:g?"Update Site":"Add Site"}),(0,a.jsx)("button",{type:"button",onClick:()=>{resetForm(),u("list")},className:"flex-1 py-2 px-4 bg-dark-bg text-white font-semibold border border-dark-border rounded-lg hover:bg-gray-800 transition-colors",children:"Cancel"})]})]})]})]})})}):null}function Home(){let{currentPersona:e,setCurrentPersona:t,redZoneActive:s,isAuthenticated:p,currentUser:b,logout:y}=(0,r.useSafety)(),[j,f]=(0,l.useState)(!0);if(!p)return(0,a.jsx)(LoginPage,{});let N=[{id:"manager",name:"Project Manager",icon:c.Z,description:"Overview & Analytics"},{id:"supervisor",name:"Site Supervisor",icon:o.Z,description:"On-site Management"},{id:"worker",name:"Worker Passport",icon:d.Z,description:"Personal Safety"}];return(0,a.jsxs)("div",{className:"min-h-screen bg-dark-bg ".concat(s?"red-zone-alert":""),children:[(0,a.jsx)(i.E.div,{initial:{x:0},animate:{x:j?0:-280},transition:{duration:.3,ease:"easeInOut"},className:"fixed left-0 top-0 h-full w-80 bg-dark-surface border-r border-dark-border z-40",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-construction-yellow rounded-lg flex items-center justify-center",children:(0,a.jsx)(x.Z,{className:"w-6 h-6 text-black"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-white",children:"SafeSite AI"}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Powered by YTL AI Cloud"})]})]}),(0,a.jsx)("button",{onClick:()=>f(!1),className:"lg:hidden text-gray-400 hover:text-white",children:(0,a.jsx)(m.Z,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"mb-6 p-3 bg-dark-bg rounded-lg border border-dark-border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-white",children:null==b?void 0:b.name}),(0,a.jsx)("p",{className:"text-xs text-gray-400 capitalize",children:null==b?void 0:b.role}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:null==b?void 0:b.email})]}),(0,a.jsx)("button",{onClick:y,className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Logout",children:(0,a.jsx)(h.Z,{className:"w-4 h-4"})})]})}),(0,a.jsx)("nav",{className:"space-y-2",children:N.filter(t=>t.id===e).map(e=>{let t=e.icon;return(0,a.jsxs)("div",{className:"w-full flex items-center space-x-4 p-4 rounded-lg bg-construction-yellow text-black",children:[(0,a.jsx)(t,{className:"w-6 h-6"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-semibold",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-black/70",children:e.description})]})]},e.id)})}),(0,a.jsxs)("div",{className:"mt-8 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 text-construction-yellow"}),(0,a.jsx)("span",{className:"text-sm font-semibold text-white",children:"System Status"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"AI Engine"}),(0,a.jsx)("span",{className:"text-green-400",children:"Online"})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Database"}),(0,a.jsx)("span",{className:"text-green-400",children:"Synced"})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Last Update"}),(0,a.jsx)("span",{className:"text-gray-300",children:"Just now"})]})]})]})]})}),(0,a.jsx)("button",{onClick:()=>f(!0),className:"fixed left-4 top-4 z-50 p-2 bg-construction-yellow rounded-lg text-black lg:hidden ".concat(j?"hidden":""),children:(0,a.jsx)(g.Z,{className:"w-5 h-5"})}),(0,a.jsx)("div",{className:"transition-all duration-300 ".concat(j?"ml-80":"ml-0"),children:(0,a.jsx)(n.M,{mode:"wait",children:(0,a.jsx)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"min-h-screen",children:(()=>{switch(e){case"manager":default:return(0,a.jsx)(ProjectManagerDashboard,{});case"supervisor":return(0,a.jsx)(SiteSupervisorApp,{});case"worker":return(0,a.jsx)(WorkerDigitalPassport,{})}})()},e)})}),(0,a.jsx)(IncidentModal,{}),(0,a.jsx)(ViolationAlert,{}),(0,a.jsx)(WorkerManagementModal,{}),(0,a.jsx)(SiteManagementModal,{})]})}}},function(e){e.O(0,[125,505,337,345,604,971,472,744],function(){return e(e.s=5873)}),_N_E=e.O()}]);